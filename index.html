<!DOCTYPE html>
<html lang="el">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Stagona - Υπολογιστής Κατανάλωσης Νερού</title>
    <!-- Font Awesome via CDNJS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" referrerpolicy="no-referrer" />

    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
    <link rel="manifest" href="/site.webmanifest" />

    <style>
        body {
            font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
            background: #f0f8ff;
            color: #333;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 1rem;
        }
        
        .container {
            background: #fff;
            padding: 2rem;
            border-radius: 1rem;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            max-width: 500px;
            width: 100%;
            position: relative;
        }
        
        .app-header {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.75rem;
            margin-bottom: 1.5rem;
            position: relative;
        }
        
        .app-logo {
            height: 96px;
            width: auto;
        }
        
        .app-title {
            font-size: 2rem;
            color: #0066cc;
            margin: 0;
        }
        
        h2 {
            text-align: center;
            margin-bottom: 1rem;
            color: #0066cc;
            font-size: 1.5rem;
        }
        
        label {
            display: block;
            margin-top: 1rem;
            font-weight: bold;
        }
        
        input,
        select {
            width: 100%;
            padding: 0.6rem;
            margin-top: 0.3rem;
            border: 1px solid #ccc;
            border-radius: 0.5rem;
            box-sizing: border-box;
        }
        
        button {
            margin-top: 1.5rem;
            width: 100%;
            padding: 0.8rem;
            background: #0066cc;
            color: #fff;
            font-size: 1rem;
            border: none;
            border-radius: 0.5rem;
            cursor: pointer;
            transition: background 0.3s;
        }
        
        button:hover {
            background: #004a99;
        }
        
        .result,
        .share-section {
            margin-top: 1.5rem;
            padding: 1rem;
            background: #e6f2ff;
            border-radius: 0.5rem;
            line-height: 1.4;
        }
        
        .share-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-top: 1rem;
        }
        
        .share-button {
            flex: 1 1 calc(25% - 0.5rem);
            text-align: center;
            padding: 0.75rem 0;
            background: #fff;
            border: 1px solid #ccc;
            border-radius: 0.5rem;
            cursor: pointer;
            transition: background 0.3s;
        }
        
        .share-button i {
            font-size: 1.5rem;
            color: #0066cc;
        }
        
        .share-button:hover {
            background: #f0f0f0;
        }
        
        .footer {
            margin-top: 2rem;
            text-align: center;
            font-size: 0.9rem;
            color: #666;
            border-top: 1px solid #eee;
            padding-top: 1rem;
        }
        
        .footer a {
            color: #0066cc;
            text-decoration: none;
        }
        
        .footer a:hover {
            text-decoration: underline;
        }
        /* Modal styles */
        
        .info-button {
            position: absolute;
            top: 0;
            right: 0;
            background: none;
            border: none;
            color: #0066cc;
            font-size: 1.25rem;
            cursor: pointer;
            padding: 0.25rem;
            transition: color 0.3s;
            z-index: 10;
            line-height: 1;
        }
        
        .info-button:hover {
            color: #004a99;
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        
        .modal-content {
            background: white;
            padding: 2rem;
            border-radius: 1rem;
            max-width: 600px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
        }
        
        .modal-close {
            top: 1rem;
            right: 1rem;
            font-size: 1.5rem;
            color: #666;
            cursor: pointer;
            background: none;
            border: none;
            padding: 0.5rem;
        }
        
        .modal-close:hover {
            color: #333;
        }
        
        .modal-logo {
            display: block;
            margin: 0 auto 1.5rem;
            height: 120px;
            width: auto;
        }
        
        .modal-section {
            margin-bottom: 1.5rem;
        }
        
        .modal-section h3 {
            color: #0066cc;
            margin-bottom: 0.5rem;
        }
        
        .modal-section p {
            margin: 0.5rem 0;
            line-height: 1.5;
        }
        
        .info-icon {
            position: absolute;
            top: 0;
            right: 0;
            font-size: 1.5rem;
            color: #0066cc;
            cursor: pointer;
        }
        
        .lang-toggle {
            position: absolute;
            top: 0;
            left: 0;
            font-size: 1rem;
            color: #0066cc;
            cursor: pointer;
            padding: 0.5rem;
            background: none;
            border: 1px solid #0066cc;
            border-radius: 0.5rem;
            transition: all 0.3s;
        }
        
        .lang-toggle:hover {
            background: #0066cc;
            color: white;
        }
        
        .result {
            margin-top: 1.5rem;
            padding: 1rem;
            background: #e6f2ff;
            border-radius: 0.5rem;
            line-height: 1.4;
        }
        
        .result-box {
            background: #fff;
            border-radius: 0.5rem;
            padding: 1.5rem;
            margin: 1rem 0;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        .result-value {
            font-size: 2.5rem;
            font-weight: bold;
            color: #0066cc;
            margin: 0;
        }
        
        .result-label {
            color: #666;
            margin: 0.5rem 0 0 0;
            font-size: 0.9rem;
        }
        
        .result-diff {
            font-size: 1.8rem;
            font-weight: bold;
            color: #0066cc;
            margin: 0;
        }
        
        .result-diff-label {
            color: #666;
            margin: 0.5rem 0 0 0;
            font-size: 0.9rem;
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="app-header">
            <i class="lang-toggle" id="langToggle" title="English">English</i>
            <img src="logo.png" alt="Stagona Logo" class="app-logo" />
            <i class="fas fa-info-circle info-icon" id="infoButton" title="Πληροφορίες"></i>
        </div>
        <h2 data-el="title">Σταγονό-μέτρο</h2>
        <strong data-el="intro">Εσύ γνωρίζεις πόσα λίτρα νερό καταναλώνεις καθημερινά στο σπίτι σου;
        Βρες ένα πρόσφατο τιμολόγιο από τον οργανισμό υδροδότησής σου, και
        συμπληρώσε τα πιο κάτω στοιχεία.</strong
      >

      <label for="total" data-el="total-label"
        >Συνολική κατανάλωση νερού (σε m³):</label
      >
      <input
        type="number"
        id="total"
        placeholder="π.χ. 30"
        min="0"
        step="0.1"
      />

      <label for="period" data-el="period-label"
        >Περίοδος κατανάλωσης (σε μήνες):</label
      >
      <select id="period" required>
        <option value="" disabled selected data-el="period-select">
          Επιλέξτε περίοδο
        </option>
        <option value="1" data-el="period-1">1 μήνας</option>
        <option value="2" data-el="period-2">2 μήνες</option>
        <option value="3" data-el="period-3">
          3 μήνες (ΕΟΑ Λ/σια, Λ/κας, Πάφου, Αμ/στου)
        </option>
        <option value="4" data-el="period-4">4 μήνες (ΕΟΑ Λ/σου)</option>
      </select>

      <label for="people" data-el="people-label"
        >Αριθμός ατόμων που μένουν μόνιμα στο σπίτι:</label
      >
      <input type="number" id="people" placeholder="π.χ. 4" min="1" step="1" />

      <button id="calc" data-el="calc-button">Υπολόγισε</button>

      <div class="result" id="result" style="display: none"></div>

      <div class="share-section" id="shareSection" style="display: none">
        <strong>Μοιραστείτε το αποτέλεσμα:</strong>
        <div class="share-buttons">
            <div class="share-button" id="shareTwitter" title="Twitter">
                <i class="fab fa-twitter"></i>
            </div>
            <div class="share-button" id="shareFacebook" title="Facebook">
                <i class="fab fa-facebook"></i>
            </div>
            <div class="share-button" id="shareWhatsApp" title="WhatsApp">
                <i class="fab fa-whatsapp"></i>
            </div>
            <div class="share-button" id="shareViber" title="Viber">
                <i class="fab fa-viber"></i>
            </div>
            <div class="share-button" id="shareEmail" title="Email">
                <i class="fas fa-envelope"></i>
            </div>
            <div class="share-button" id="copySummary" title="Αντέγραψε περίληψη">
                <i class="fas fa-clipboard"></i>
            </div>
        </div>
    </div>
    <div class="footer">
        Created by
        <a href="https://www.kios.ucy.ac.cy/eliades" target="_blank">Demetrios Eliades</a
        >. Copyright (C)
        <a href="https://www.kios.ucy.ac.cy" target="_blank"
          >KIOS Research and Innovation Center of Excellence</a
        >,
        <a href="https://www.ucy.ac.cy" target="_blank">University of Cyprus</a>
    </div>
    </div>

    <!-- Modal -->
    <div class="modal" id="aboutModal">
        <div class="modal-content">
            <button class="modal-close" id="modalClose">&times;</button>

            <div class="modal-section">
                <br /><br />
                <h3 data-el="about-title">Σχετικά με το Stagona App</h3>
                <p data-el="about-desc">
                    Υπολογιστής σχεδιασμένος για να βοηθά τα νοικοκυριά στην Κύπρο να κατανοήσουν και να βελτιστοποιήσουν την κατανάλωση νερού τους. Η εφαρμογή συγκρίνει την κατανάλωση νερού σας με τον μέσο όρο και παρέχει συστάσεις για την εξοικονόμηση νερού.
                </p>
            </div>

            <div class="modal-section">
                <h3 data-el="how-to-title">Πώς να το χρησιμοποιήσετε</h3>
                <p data-el="how-to-1">
                    1. Βρείτε τον λογαριασμό κατανάλωσης νερού σας
                </p>
                <p data-el="how-to-2">
                    2. Εισάγετε τη συνολική κατανάλωση νερού σας σε κυβικά μέτρα (m³) όπως αναγράφεται στον λογαριασμό
                </p>
                <p data-el="how-to-3">3. Επιλέγετε την ορθή περίοδο χρέωσης</p>
                <p data-el="how-to-4">
                    4. Εισάγετε τον αριθμό των ατόμων έχουν ως μόνιμη κατοικία τους το νοικοκυριό
                </p>
                <p data-el="how-to-5">
                    5. Κάντε κλικ στο "Υπολόγισε" για να δείτε τα αποτελέσματα
                </p>
            </div>

            <div class="modal-section">
                <h3 data-el="tips-title">Συμβουλές εξοικονόμησης νερού</h3>
                <p data-el="tip-1">
                    • Κάντε πιο σύντομα ντους (στοχεύστε για 5 λεπτά ή λιγότερο)
                </p>
                <p data-el="tip-2">• Εντοπίστε και επισκευάστε τυχόν διαρροές</p>
                <p data-el="tip-3">
                    • Χρησιμοποιήστε πλήρη φορτίο στα πλυντήρια και στα πλυντήρια πιάτων
                </p>
                <p data-el="tip-4">
                    • Συλλέξτε νερό σε κουβάδες για επαναχρησιμοποίηση
                </p>
            </div>

            <div class="modal-section">
                <h3>Έκδοση</h3>
                <p>0.9</p>
            </div>
        </div>
    </div>

    <script>
        // Translations object
        const translations = {
            el: {
                title: "Σταγονό-μέτρο",
                intro: "Εσύ γνωρίζεις πόσα λίτρα νερό καταναλώνεις καθημερινά στο σπίτι σου; Βρες ένα πρόσφατο τιμολόγιο από τον οργανισμό υδροδότησής σου, και συμπληρώσε τα πιο κάτω στοιχεία.",
                "total-label": "Συνολική κατανάλωση νερού (σε m³):",
                "period-label": "Περίοδος κατανάλωσης (σε μήνες):",
                "period-1": "1 μήνας",
                "period-2": "2 μήνες",
                "period-3": "3 μήνες (ΕΟΑ Λ/σια, Λ/κας, Πάφου, Αμ/στου)",
                "period-4": "4 μήνες (ΕΟΑ Λ/σου)",
                "people-label": "Αριθμός ατόμων που μένουν μόνιμα στο σπίτι:",
                "calc-button": "Υπολόγισε",
                "liters": "λίτρα",
                "about-title": "Σχετικά με το Stagona App",
                "about-desc": "Υπολογιστής σχεδιασμένος για να βοηθά τα νοικοκυριά στην Κύπρο να κατανοήσουν και να βελτιστοποιήσουν την κατανάλωση νερού τους. Η εφαρμογή συγκρίνει την κατανάλωση νερού σας με τον μέσο όρο και παρέχει συστάσεις για την εξοικονόμηση νερού.",
                "how-to-title": "Πώς να το χρησιμοποιήσετε",
                "how-to-1": "1. Βρείτε τον λογαριασμό κατανάλωσης νερού σας",
                "how-to-2": "2. Εισάγετε τη συνολική κατανάλωση νερού σας σε κυβικά μέτρα (m³) όπως αναγράφεται στον λογαριασμό",
                "how-to-3": "3. Επιλέγετε την ορθή περίοδο χρέωσης",
                "how-to-4": "4. Εισάγετε τον αριθμό των ατόμων έχουν ως μόνιμη κατοικία τους το νοικοκυριό",
                "how-to-5": '5. Κάντε κλικ στο "Υπολόγισε" για να δείτε τα αποτελέσματα',
                "tips-title": "Συμβουλές εξοικονόμησης νερού",
                "tip-1": "• Κάντε πιο σύντομα ντους (στοχεύστε για 5 λεπτά ή λιγότερο)",
                "tip-2": "• Εντοπίστε και επισκευάστε τυχόν διαρροές",
                "tip-3": "• Χρησιμοποιήστε πλήρη φορτίο στα πλυντήρια και στα πλυντήρια πιάτων",
                "tip-4": "• Συλλέξτε νερό σε κουβάδες για επαναχρησιμοποίηση",
                "result-title": "Μέση κατανάλωση ανά άτομο/ημέρα:",
                "result-diff": "Διαφορά από το μέσο όρο (140 λίτρα):",
                "result-below": "Κάτω κατά",
                "result-above": "Πάνω κατά",
                "result-excellent": "Εξαιρετικά! Καταναλώνετε 20% λιγότερο νερό από τον μέσο όρο.",
                "result-excellent-desc": "Αν όλοι οι καταναλωτές είχαν αυτή την κατανάλωση, θα εξοικονομούσαμε περίπου 10 εκατ. m³ νερού ετησίως, που θα αρκούσε για να υδροδοτηθούν 200,000 άτομα για ένα χρόνο (που αντιστοιχεί στο πληθυσμό της Επαρχίας Λάρνακας και Αμμοχώστου)! Συνεχίστε έτσι και βοηθήστε να εδραιωθεί η υδατική συνείδηση στην Κύπρο!",
                "result-good": "Μπράβο! Καταναλώνετε 10% λιγότερο νερό από τον μέσο όρο.",
                "result-good-desc": "Εάν όλοι οι καταναλωτές είχαν αυτή την κατανάλωση, θα εξοικονομούσαμε περίπου 5 εκατ. m³ νερού ετησίως, που θα αρκούσε για να υδροδοτηθούν 100,000 άτομα για ένα χρόνο (που αντιστοιχεί στο πληθυσμό της Επαρχίας Πάφου)! Συνεχίστε έτσι, και με κάποιες μικρές αλλαγές, όπως πιο σύντομα ντους κατά 1-2 λεπτά, και χρήση πλυντηρίου με πλήρες γέμισμα, θα σας φέρουν ακόμη πιο κοντά στους κορυφαίους καταναλωτές!",
                "result-average": "Πολύ καλά! είστε ελαφρώς κάτω από τον μέσο όρο.",
                "result-average-desc": "Αν όλοι είχαμε αυτή την κατανάλωση, θα εξοικονομούσαμε σχεδόν 2.5 εκατ. m³ ετησίως, που θα αρκούσε για να υδροδοτηθούν 50,000 άτομα για ένα χρόνο (που αντιστοιχεί στο πληθυσμό της Επαρχίας Αμμοχώστου)! Συνεχίστε έτσι, και με κάποιες μικρές αλλαγές, όπως πιο σύντομα ντους κατά 2-3 λεπτά, και χρήση πλυντηρίου με πλήρες γέμισμα, θα σας φέρουν ακόμη πιο κοντά στους κορυφαίους καταναλωτές!",
                "result-slightly-high": "Είστε πολύ κοντά στο μέσο όρο!",
                "result-slightly-high-desc": "Μειώνοντας μόλις 15 λίτρα/ημέρα (π.χ. 1-2 λεπτά λιγότερο στο ντους), θα μπορούσατε να φτάσετε το μέσο όρο!",
                "result-high": "Προσοχή! βρίσκεστε 10% πάνω από τον μέσο όρο.",
                "result-high-desc": "Μπορείτε να φτάσετε το μέσο όρο, αν μειώσετε κατά 2-3 λεπτά το καθημερινό ντους, και αποφυγή χρήσης/μείωσης τρεχούμενου νερού για πότισμα.",
                "result-very-high": "Προειδοποίηση: Βρίσκεστε μέσα στους λίγους καταναλωτές με 20% πάνω από τον μέσο όρο.",
                "result-very-high-desc": "Ο μέσος καταναλωτής στην Κύπρο καταναλώνει 140 λίτρα/ημέρα. Ξεκινήστε άμεσα με μικρές αλλαγές για να φτάσετε τον μέσο όρο. μειώσετε κατά 2-3 λεπτά το καθημερινό ντους, και αποφυγή χρήσης/μείωσης τρεχούμενου νερού για πότισμα. Ελέγξτε για τυχών διαρροές στο στο σπίτι σας, παρακολουθώντας την κατανάλωση στον μετρητή σας τις ώρες που απουσιάζετε από το σπίτι.",
                "share-title": "Μοιραστείτε το αποτέλεσμα:",
                "copy-success": "Αντιγράφηκε!",
            },
            en: {
                title: "Water Consumption Calculator",
                intro: "Do you know how many liters of water you consume daily in your home? Find a recent bill from your water supplier and fill in the details below.",
                "total-label": "Total water consumption (in m³):",
                "period-label": "Consumption period (in months):",
                "period-1": "1 month",
                "period-2": "2 months",
                "period-3": "3 months (EOA Larnaca, Limassol, Paphos, Famagusta)",
                "period-4": "4 months (EOA Nicosia)",
                "people-label": "Number of people living in the house:",
                "calc-button": "Calculate",
                "liters": "liters",
                "about-title": "About Stagona App",
                "about-desc": "A calculator designed to help households in Cyprus understand and optimize their water consumption. The app compares your water consumption with the average and provides recommendations for water saving.",
                "how-to-title": "How to use it",
                "how-to-1": "1. Find your water consumption bill",
                "how-to-2": "2. Enter your total water consumption in cubic meters (m³) as shown on the bill",
                "how-to-3": "3. Select the correct billing period",
                "how-to-4": "4. Enter the number of permanent residents in the household",
                "how-to-5": '5. Click "Calculate" to see the results',
                "tips-title": "Water saving tips",
                "tip-1": "• Take shorter showers (aim for 5 minutes or less)",
                "tip-2": "• Find and fix any leaks",
                "tip-3": "• Use full loads in washing machines and dishwashers",
                "tip-4": "• Collect water in buckets for reuse",
                "result-title": "Average consumption per person/day:",
                "result-diff": "Difference from average (140 liters):",
                "result-below": "Below by",
                "result-above": "Above by",
                "result-excellent": "Excellent! You consume 20% less water than the average.",
                "result-excellent-desc": "If all consumers had this consumption, we would save about 10 million m³ of water annually, which would be enough to supply 200,000 people for a year (equivalent to the population of Larnaca and Famagusta Districts)! Keep it up, and help establish water consciousness in Cyprus!",
                "result-good": "Well done! You consume 10% less water than the average.",
                "result-good-desc": "If all consumers had this consumption, we would save about 5 million m³ of water annually, which would be enough to supply 100,000 people for a year (equivalent to the population of Paphos District)! Keep it up, and with some small changes, such as shorter showers by 1-2 minutes, and using full loads in washing machines, you'll get even closer to the top consumers!",
                "result-average": "Very good! You're slightly below average.",
                "result-average-desc": "If everyone had this consumption, we would save almost 2.5 million m³ annually, which would be enough to supply 50,000 people for a year (equivalent to the population of Famagusta District)! Keep it up, and with some small changes, such as shorter showers by 2-3 minutes, and using full loads in washing machines, you'll get even closer to the top consumers!",
                "result-slightly-high": "You're very close to the average!",
                "result-slightly-high-desc": "By reducing just 15 liters/day (e.g., 1-2 minutes less in the shower), you could reach the average!",
                "result-high": "Attention! You're 10% above the average.",
                "result-high-desc": "You can reach the average by reducing your daily shower by 2-3 minutes and avoiding/reducing running water for irrigation.",
                "result-very-high": "Warning: You're among the few consumers who are 20% above the average.",
                "result-very-high-desc": "The average consumer in Cyprus consumes 140 liters/day. Start immediately with small changes to reach the average. Reduce your daily shower by 2-3 minutes and avoid/reduce running water for irrigation. Check for any leaks in your home by monitoring your meter during hours when you're away from home.",
                "share-title": "Share your result with friends and family:",
                "copy-success": "Copied!",
            },
        };

        let currentLang = "el";

        // Function to update text content
        function updateLanguage(lang) {
            const elements = document.querySelectorAll("[data-el]");
            elements.forEach((element) => {
                const key = element.getAttribute("data-el");
                if (translations[lang][key]) {
                    if (element.tagName === "INPUT" || element.tagName === "SELECT") {
                        element.placeholder = translations[lang][key];
                    } else {
                        element.textContent = translations[lang][key];
                    }
                }
            });
            document.getElementById("langToggle").textContent =
                lang === "el" ? "English" : "Ελληνικά";
            document.getElementById("langToggle").title =
                lang === "el" ? "English" : "Ελληνικά";
            currentLang = lang;

            // Update existing results if they are displayed
            const result = document.getElementById("result");
            if (result.style.display !== "none") {
                const totalM3 = parseFloat(document.getElementById("total").value);
                const months = parseInt(document.getElementById("period").value);
                const people = parseInt(document.getElementById("people").value);
                const avg = 140;

                const totalLitres = totalM3 * 1000;
                const days = months * 30.4;
                const perDay = totalLitres / days / people;
                const diffPct = ((perDay - avg) / avg) * 100;

                let msg = `
            <div class="result-box">
              <p class="result-value">${perDay.toFixed(1)} ${translations[lang]["liters"]}</p>
              <p class="result-label">${translations[lang]["result-title"]}</p>
            </div>
            <div class="result-box">
              <p class="result-diff">${
                perDay < avg
                  ? `${translations[lang]["result-below"]} ${Math.abs(diffPct).toFixed(1)}%`
                  : `${translations[lang]["result-above"]} ${diffPct.toFixed(1)}%`
              }</p>
              <p class="result-diff-label">${translations[lang]["result-diff"]}</p>
            </div>
            <br/>`;

          if (diffPct < -20) {
            msg += `${translations[lang]["result-excellent"]}<br/><br/>${translations[lang]["result-excellent-desc"]}`;
          } else if (diffPct >= -20 && diffPct < -10) {
            msg += `${translations[lang]["result-good"]}<br/><br/>${translations[lang]["result-good-desc"]}`;
          } else if (diffPct >= -10 && diffPct < 0) {
            msg += `${translations[lang]["result-average"]}<br/><br/>${translations[lang]["result-average-desc"]}`;
          } else if (diffPct >= 0 && diffPct < 10) {
            msg += `${translations[lang]["result-slightly-high"]}<br/><br/>${translations[lang]["result-slightly-high-desc"]}`;
          } else if (diffPct >= 10 && diffPct < 20) {
            msg += `${translations[lang]["result-high"]}<br/><br/>${translations[lang]["result-high-desc"]}`;
          } else {
            msg += `${translations[lang]["result-very-high"]}<br/><br/>${translations[lang]["result-very-high-desc"]}`;
          }

          result.innerHTML = msg;

          // Update share section if it's visible
          const shareSection = document.getElementById("shareSection");
          if (shareSection.style.display !== "none") {
            const base = `${location.origin}${location.pathname}`;
            const url = base;

            let summary =
              lang === "el"
                ? `Μόλις υπολόγισα την κατανάλωσή νερού μου: ${perDay.toFixed(
                    1
                  )} λίτρα/ημέρα ` +
                  (perDay < avg
                    ? `(κάτω ${Math.abs(diffPct).toFixed(
                        1
                      )}% από τον μέσο όρο των 140 λίτρων/ημέρα)`
                    : `(πάνω ${diffPct.toFixed(
                        1
                      )}% από τον μέσο όρο των 140 λίτρων/ημέρα)`) +
                  `. Δοκίμασέ το και εσύ: ${url}`
                : `I just calculated my water consumption: ${perDay.toFixed(
                    1
                  )} liters/day ` +
                  (perDay < avg
                    ? `(below average by ${Math.abs(diffPct).toFixed(
                        1
                      )}% from the average of 140 liters/day)`
                    : `(above average by ${diffPct.toFixed(
                        1
                      )}% from the average of 140 liters/day)`) +
                  `. Try it yourself: ${url}`;

            const enc = encodeURIComponent(summary);

            document.getElementById("shareTwitter").onclick = () =>
              window.open(
                `https://twitter.com/intent/tweet?text=${enc}`,
                "_blank"
              );
            document.getElementById("shareFacebook").onclick = () =>
              window.open(
                `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(
                  url
                )}&quote=${enc}`,
                "_blank"
              );
            document.getElementById("shareWhatsApp").onclick = () =>
              window.open(`https://wa.me/?text=${enc}`, "_blank");
            document.getElementById("shareViber").onclick = () =>
              window.open(`viber://forward?text=${enc}`, "_blank");
            document.getElementById("shareEmail").onclick = () =>
              window.open(
                `mailto:?subject=${
                  lang === "el" ? "Κατανάλωση νερού" : "Water Consumption"
                }&body=${enc}`,
                "_blank"
              );
            document.getElementById("copySummary").onclick = () =>
              navigator.clipboard
                .writeText(summary)
                .then(() => alert(translations[lang]["copy-success"]));
          }
        }
      }

      // Language toggle button click handler
      document.getElementById("langToggle").addEventListener("click", () => {
        const newLang = currentLang === "el" ? "en" : "el";
        updateLanguage(newLang);
      });

      document.getElementById("calc").addEventListener("click", () => {
        const totalM3 = parseFloat(document.getElementById("total").value);
        const months = parseInt(document.getElementById("period").value);
        const people = parseInt(document.getElementById("people").value);
        const avg = 140;

        if (!totalM3 || !months || !people) {
          alert(
            currentLang === "el"
              ? "Παρακαλώ συμπληρώστε σωστά όλα τα πεδία."
              : "Please fill in all fields correctly."
          );
          return;
        }

        const totalLitres = totalM3 * 1000;
        const days = months * 30.4;
        const perDay = totalLitres / days / people;
        const diffPct = ((perDay - avg) / avg) * 100;

        let msg = `
          <div class="result-box">
            <p class="result-value">${perDay.toFixed(1)} λίτρα</p>
            <p class="result-label">${translations[currentLang]["result-title"]}</p>
          </div>
          <div class="result-box">
            <p class="result-diff">${
              perDay < avg
                ? `${translations[currentLang]["result-below"]} ${Math.abs(diffPct).toFixed(1)}%`
                : `${translations[currentLang]["result-above"]} ${diffPct.toFixed(1)}%`
            }</p>
            <p class="result-diff-label">${translations[currentLang]["result-diff"]}</p>
          </div>
          <br/>`;

        if (diffPct < -20) {
          msg += `${translations[currentLang]["result-excellent"]}<br/><br/>${translations[currentLang]["result-excellent-desc"]}`;
        } else if (diffPct >= -20 && diffPct < -10) {
          msg += `${translations[currentLang]["result-good"]}<br/><br/>${translations[currentLang]["result-good-desc"]}`;
        } else if (diffPct >= -10 && diffPct < 0) {
          msg += `${translations[currentLang]["result-average"]}<br/><br/>${translations[currentLang]["result-average-desc"]}`;
        } else if (diffPct >= 0 && diffPct < 10) {
          msg += `${translations[currentLang]["result-slightly-high"]}<br/><br/>${translations[currentLang]["result-slightly-high-desc"]}`;
        } else if (diffPct >= 10 && diffPct < 20) {
          msg += `${translations[currentLang]["result-high"]}<br/><br/>${translations[currentLang]["result-high-desc"]}`;
        } else {
          msg += `${translations[currentLang]["result-very-high"]}<br/><br/>${translations[currentLang]["result-very-high-desc"]}`;
        }

        const result = document.getElementById("result");
        result.innerHTML = msg;
        result.style.display = "block";

        const base = `${location.origin}${location.pathname}`;
        const params = `?total=${totalM3}&period=${months}&people=${people}`;
        const url = base;
        document.getElementById("shareSection").style.display = "block";

        let summary =
          currentLang === "el"
            ? `Μόλις υπολόγισα την κατανάλωσή νερού μου: ${perDay.toFixed(
                1
              )} λίτρα/ημέρα ` +
              (perDay < avg
                ? `(κάτω ${Math.abs(diffPct).toFixed(
                    1
                  )}% από τον μέσο όρο των 140 λίτρων/ημέρα)`
                : `(πάνω ${diffPct.toFixed(
                    1
                  )}% από τον μέσο όρο των 140 λίτρων/ημέρα)`) +
              `. Δοκίμασέ το και εσύ: ${url}`
            : `I just calculated my water consumption: ${perDay.toFixed(
                1
              )} liters/day ` +
              (perDay < avg
                ? `(below average by ${Math.abs(diffPct).toFixed(
                    1
                  )}% from the average of 140 liters/day)`
                : `(above average by ${diffPct.toFixed(
                    1
                  )}% from the average of 140 liters/day)`) +
              `. Try it yourself: ${url}`;

        const enc = encodeURIComponent(summary);

        document.getElementById("shareTwitter").onclick = () =>
          window.open(`https://twitter.com/intent/tweet?text=${enc}`, "_blank");
        document.getElementById("shareFacebook").onclick = () =>
          window.open(
            `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(
              url
            )}&quote=${enc}`,
            "_blank"
          );
        document.getElementById("shareWhatsApp").onclick = () =>
          window.open(`https://wa.me/?text=${enc}`, "_blank");
        document.getElementById("shareViber").onclick = () =>
          window.open(`viber://forward?text=${enc}`, "_blank");
        document.getElementById("shareEmail").onclick = () =>
          window.open(
            `mailto:?subject=${
              currentLang === "el" ? "Κατανάλωση νερού" : "Water Consumption"
            }&body=${enc}`,
            "_blank"
          );
        document.getElementById("copySummary").onclick = () =>
          navigator.clipboard
            .writeText(summary)
            .then(() => alert(translations[currentLang]["copy-success"]));
      });

      // Modal functionality
      const modal = document.getElementById("aboutModal");
      const infoButton = document.getElementById("infoButton");
      const modalClose = document.getElementById("modalClose");

      infoButton.onclick = () => {
        modal.style.display = "flex";
      };

      modalClose.onclick = () => {
        modal.style.display = "none";
      };

      window.onclick = (event) => {
        if (event.target === modal) {
          modal.style.display = "none";
        }
      };
    </script>
</body>

</html>