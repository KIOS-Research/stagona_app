<!DOCTYPE html>
<html lang="el">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-title" content="Stagona">


    <title data-el="app-title"></title>
    <!-- Font Awesome via CDNJS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" referrerpolicy="no-referrer" />

    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
    <link rel="manifest" href="/site.webmanifest" />

    <style>
         :root {
            --primary: #0066cc;
            --secondary: #4caf50;
            --danger: #e53935;
            --bg-gradient: linear-gradient(135deg, #e0f7fa 0%, #80deea 100%);
            --font: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        * {
            box-sizing: border-box;
        }
        
        body {
            font-family: var(--font);
            background: var(--bg-gradient);
            color: #333;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 1rem;
        }
        
        .container {
            background: #fff;
            padding: 2rem;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            max-width: 500px;
            width: 100%;
            position: relative;
            margin-bottom: 2rem;
            animation: fadeIn 0.8s ease-in-out;
        }
        
        .app-header {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.75rem;
            margin-bottom: 1.5rem;
            position: relative;
        }
        
        .app-logo {
            height: 96px;
            width: auto;
        }
        
        .app-title {
            font-size: 2rem;
            color: var(--primary);
            margin: 0;
        }
        
        h2 {
            text-align: center;
            margin-bottom: 1rem;
            color: var(--primary);
            font-size: 1.5rem;
        }
        
        label {
            display: block;
            margin-top: 1rem;
            font-weight: 500;
        }
        
        input,
        select {
            width: 100%;
            padding: 0.8rem;
            margin-top: 0.3rem;
            border: 1px solid #ccc;
            border-radius: 8px;
            box-sizing: border-box;
            transition: border-color 0.3s, box-shadow 0.3s;
        }
        
        input:focus,
        select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(0, 102, 204, 0.2);
        }
        
        button {
            margin-top: 1.5rem;
            width: 100%;
            padding: 1.2rem;
            background: var(--primary);
            color: #fff;
            font-size: 1rem;
            font-weight: 500;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s, background 0.3s;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.15);
        }
        
        button:hover {
            background: #004a99;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }
        
        .result,
        .share-section {
            margin-top: 1.5rem;
            padding: 1.5rem;
            background: #e6f2ff;
            border-radius: 8px;
            line-height: 1.4;
            animation: fadeIn 0.5s ease-in-out;
        }
        
        .share-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-top: 1rem;
        }
        
        .share-button {
            flex: 1 1 calc(25% - 0.5rem);
            text-align: center;
            padding: 0.75rem 0;
            background: #fff;
            border: 1px solid #ccc;
            border-radius: 8px;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s, background 0.3s;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
        }
        
        .share-button i {
            font-size: 1.5rem;
            color: var(--primary);
        }
        
        .share-button:hover {
            background: #f0f0f0;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }
        
        .footer {
            text-align: center;
            font-size: 0.9rem;
            color: #666;
            border-top: 1px solid #eee;
            padding-top: 1rem;
            width: 100%;
            max-width: 500px;
        }
        
        .footer a {
            color: var(--primary);
            text-decoration: none;
            transition: color 0.3s;
        }
        
        .footer a:hover {
            color: #004a99;
            text-decoration: underline;
        }
        
        .result-box {
            background: #fff;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1rem 0;
            text-align: center;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
            animation: fadeIn 0.5s ease-in-out;
        }
        
        .result-value {
            font-size: 2.5rem;
            font-weight: bold;
            color: var(--primary);
            margin: 0;
        }
        
        .result-label {
            color: #666;
            margin: 0.5rem 0 0 0;
            font-size: 0.9rem;
        }
        
        .result-diff {
            font-size: 1.8rem;
            font-weight: bold;
            color: var(--primary);
            margin: 0;
        }
        
        .result-diff-label {
            color: #666;
            margin: 0.5rem 0 0 0;
            font-size: 0.9rem;
        }
        
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: scale(0.95);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }
        /* Modal styles */
        
        .info-button {
            position: absolute;
            top: 0;
            right: 0;
            background: none;
            border: none;
            color: #0066cc;
            font-size: 1.25rem;
            cursor: pointer;
            padding: 0.25rem;
            transition: color 0.3s;
            z-index: 10;
            line-height: 1;
        }
        
        .info-button:hover {
            color: #004a99;
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        
        .modal-content {
            background: white;
            padding: 2rem;
            border-radius: 12px;
            max-width: 500px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }
        
        .modal-close {
            position: absolute;
            top: 1rem;
            right: 1rem;
            font-size: 1.5rem;
            color: var(--primary);
            cursor: pointer;
            transition: color 0.3s, transform 0.2s;
            padding: 0.5rem;
            z-index: 10;
        }
        
        .modal-close:hover {
            color: #004a99;
            transform: scale(1.1);
        }
        
        .modal-logo {
            display: block;
            margin: 0 auto 1.5rem;
            height: 120px;
            width: auto;
        }
        
        .modal-section {
            margin-bottom: 1.5rem;
        }
        
        .modal-section h3 {
            color: #0066cc;
            margin-bottom: 0.5rem;
        }
        
        .modal-section p {
            margin: 0.5rem 0;
            line-height: 1.5;
        }
        
        .info-icon {
            position: absolute;
            top: 0;
            right: 0;
            font-size: 1.5rem;
            color: #0066cc;
            cursor: pointer;
        }
        
        .lang-toggle {
            position: absolute;
            top: 0;
            left: 0;
            font-size: 1rem;
            color: #0066cc;
            cursor: pointer;
            padding: 0.5rem;
            background: none;
            border: 1px solid #0066cc;
            border-radius: 0.5rem;
            transition: all 0.3s;
        }
        
        .lang-toggle:hover {
            background: #0066cc;
            color: white;
        }
        /* Notice Modal Styles */
        
        .notice-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        
        .notice-modal-content {
            background-color: white;
            padding: 2rem;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            max-width: 400px;
            width: 90%;
            position: relative;
            animation: fadeIn 0.3s ease-in-out;
        }
        
        .notice-modal-close {
            position: absolute;
            top: 1rem;
            right: 1rem;
            font-size: 1.5rem;
            color: #666;
            cursor: pointer;
            transition: color 0.3s;
        }
        
        .notice-modal-close:hover {
            color: var(--danger);
        }
        
        .notice-modal-message {
            margin: 1rem 0;
            text-align: center;
            font-size: 1.1rem;
            line-height: 1.5;
        }
        
        .notice-modal-button {
            display: block;
            width: 100%;
            padding: 0.75rem;
            margin-top: 1rem;
            background-color: var(--primary);
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 1rem;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        .notice-modal-button:hover {
            background-color: #0052a3;
        }
        
        .privacy-notice {
            text-align: center;
            font-size: 0.9rem;
            color: #666;
            margin-top: 1rem;
            font-style: italic;
            line-height: 1.4;
        }
        
        .modal-logos {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 2rem;
            margin-bottom: 1.5rem;
            padding-top: 1rem;
        }
        
        .modal-logo {
            height: 48px;
            width: auto;
            object-fit: contain;
        }
        
        .email-link {
            color: var(--primary);
            text-decoration: none;
            cursor: pointer;
            transition: color 0.3s;
        }
        
        .email-link:hover {
            color: #004a99;
            text-decoration: underline;
        }
        
        .privacy-link {
            color: var(--primary);
            text-decoration: none;
            transition: color 0.3s;
            font-size: 0.9rem;
        }
        
        .privacy-link:hover {
            color: #004a99;
            text-decoration: underline;
        }
        
        .about-link {
            color: var(--primary);
            text-decoration: none;
            cursor: pointer;
            transition: color 0.3s;
        }
        
        .about-link:hover {
            color: #004a99;
            text-decoration: underline;
        }
        
        .example-link {
            color: var(--primary);
            text-decoration: none;
            cursor: pointer;
            font-size: 0.9rem;
            margin-left: 0.3rem;
            transition: color 0.3s;
            display: inline-block;
        }
        
        .example-link:hover {
            color: #004a99;
            text-decoration: underline;
        }
        
        .example-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        
        .example-modal-content {
            background-color: #fefefe;
            margin: 5% auto;
            padding: 20px;
            border: 1px solid #888;
            width: 90%;
            max-width: 600px;
            border-radius: 8px;
            position: relative;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .example-image {
            max-width: 80%;
            height: auto;
            display: block;
            margin: 1rem auto;
        }
        
        .example-modal-close {
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            font-size: 1.5rem;
            color: var(--primary);
            cursor: pointer;
            transition: color 0.3s, transform 0.2s;
            padding: 0.5rem;
            z-index: 10;
        }
        
        .example-modal-close:hover {
            color: #004a99;
            transform: scale(1.1);
        }
        
        label[for="total"] {
            display: inline-block;
            margin-right: 0.2rem;
        }
        
        .gauge-track {
            width: 100%;
            height: 14px;
            background: #eee;
            border-radius: 7px;
            margin-bottom: .4rem
        }
        
        .gauge-fill {
            height: 100%;
            background: #4caf50;
            border-radius: 7px;
            transition: width .6s ease, background .6s ease
        }
        
        .subtitle {
            text-align: center;
            color: var(--primary);
            font-size: 1rem;
            font-weight: 500;
        }
        
        .scarcity-banner {
            background: #ffefc5;
            padding: .75rem 1rem .75rem 1rem;
            padding-right: 3rem;
            border-radius: 8px;
            font-size: .95rem;
            margin-bottom: 1.25rem;
            position: relative;
        }
        
        .scarcity-banner span {
            padding-right: 2rem;
        }
        
        .action-banner {
            background: #e8f5e8;
            padding: .75rem 1rem .75rem 1rem;
            padding-right: 3rem;
            border-radius: 8px;
            font-size: .95rem;
            margin-bottom: 1.25rem;
            position: relative;
        }
        
        .action-banner span {
            padding-right: 2rem;
        }
        
        .why-banner {
            background: #e3f2fd;
            padding: .75rem 1rem .75rem 1rem;
            padding-right: 3rem;
            border-radius: 8px;
            font-size: .95rem;
            margin-bottom: 1.25rem;
            position: relative;
        }
        
        .why-banner span {
            padding-right: 2rem;
        }
        
        .info-icon {
            cursor: pointer;
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
        }
        
        .info-icon-orange {
            color: #ff9800;
        }
        
        .info-icon-green {
            color: #4caf50;
        }
        
        .info-icon-blue {
            color: #2196f3;
        }
        
        .instructions-text {
            font-size: 0.95rem;
            margin-bottom: 0.5rem;
            text-align: left;
            line-height: 1.5;
            transition: all 0.3s ease;
            background: #e3f2fd;
            padding: 1rem;
            border-radius: 8px;
        }
        
        .instructions-text:target {
            border-radius: 8px;
            padding: 1rem;
        }
        
        @keyframes highlight {
            0% {
                background: linear-gradient(135deg, #fff3cd 0%, #f8d7da 100%);
                transform: scale(1.02);
            }
            100% {
                background: linear-gradient(135deg, #e8f5e8 0%, #f3e5f5 100%);
                transform: scale(1);
            }
        }
        
        .how-it-works-image {
            text-align: center;
        }
        
        .how-it-works-image img {
            max-width: 60%;
            height: auto;
        }
        
        .tips-button {
            margin: 0 0;
            background: var(--secondary);
            color: #fff;
            font-weight: bold;
            width: 100%;
        }
        
        .reminder-button {
            margin: 0.5rem 0 1.5rem 0;
            background: #ff9800;
            color: #fff;
            font-weight: bold;
            width: 100%;
        }
        
        .progress-reminder {
            background: #e3f2fd;
            padding: .75rem 1rem;
            padding-right: 3rem;
            border-radius: 8px;
            font-size: .9rem;
            margin-top: 1.25rem;
            text-align: left;
            color: #1976d2;
            position: relative;
        }
        
        .jump-link {
            color: var(--primary);
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            border-radius: 25px;
            background: #e3f2fd;
            border: 2px solid var(--primary);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        .jump-link:hover {
            background: #bbdefb;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            text-decoration: none;
        }
        
        .jump-link:active {
            transform: translateY(0);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        .jump-link i {
            font-size: 0.9em;
            animation: bounce 2s infinite;
        }
        
        @keyframes bounce {
            0%,
            20%,
            50%,
            80%,
            100% {
                transform: translateY(0);
            }
            40% {
                transform: translateY(-3px);
            }
            60% {
                transform: translateY(-2px);
            }
        }
        
        .section-separator {
            position: relative;
            height: 40px;
            margin: 1.5rem 0;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .section-separator::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(to right, transparent, #ccc, transparent);
            transform: translateY(-50%);
        }
        
        .section-separator i {
            background: #fff;
            color: #666;
            padding: 0 1rem;
            font-size: 1.2rem;
            position: relative;
            z-index: 1;
        }
        
        .share-section {
            margin-top: 1.5rem;
            padding: 0;
            width: 100%;
            background: none;
            border-radius: 0;
            line-height: 1.4;
            animation: fadeIn 0.5s ease-in-out;
            box-sizing: border-box;
        }
        
        .pledge-slider-section {
            width: 100%;
            border-radius: 8px;
            box-sizing: border-box;
        }
        
        #pledgeSlider {
            padding: 0;
        }
        
        #resultSummary {
            margin-top: 1.2rem;
            font-size: 0.97rem;
            font-style: italic;
            text-align: left;
            background: #f7fafd;
            border-left: 4px solid #b3d1f7;
            padding: 0.8em 1em;
            color: #444;
            border-radius: 6px;
            box-shadow: 0 1px 4px rgba(0, 0, 0, 0.04);
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="app-header">
            <i class="lang-toggle" id="langToggle" title="English"></i>
            <img src="logo.png" alt="Stagona Water Consumption Calculator Logo" class="app-logo" />
            <i class="fas fa-info-circle info-icon" id="infoButton" title="About"></i>
        </div>
        <h2 data-el="title"></h2>
        <h3 class="subtitle">
            <span data-el="intro-question"></span>
        </h3>
        <div class="jump-link-container" style="text-align:center; margin-bottom:1.25rem;">
            <a href="#instructions" class="jump-link"><span data-el="jump-link-btn"></span> <i class="fas fa-arrow-down"></i></a>
        </div>

        <div id="scarcityBanner" class="scarcity-banner">
            <span data-el="scarcity-msg"></span>
            <i class="fas fa-info-circle info-icon info-icon-orange" id="stressInfo"></i>
        </div>

        <div id="whyBanner" class="why-banner">
            <span data-el="why-msg"></span>
        </div>

        <div id="actionBanner" class="action-banner">
            <span data-el="action-msg"></span>
            <i class="fas fa-info-circle info-icon info-icon-green" id="actionInfo"></i>
        </div>

        <div class="section-separator">
            <i class="fas fa-cog"></i>
        </div>

        <div class="instructions-text" id="instructions">
            <span data-el="intro-instructions"></span>
            <div class="how-it-works-image">
                <img src="howitworks.png" alt="How the Stagona water consumption calculator works">
            </div>

        </div>
        <div>
            <label for="total"><span data-el="total-label"></span><a href="#" class="example-link" data-el="example-link"></a></label>
        </div>
        <input type="number" id="total" data-el="total-placeholder" min="0" step="0.1" />

        <label for="period" data-el="period-label"></label>
        <select id="period" required>
            <option value="" disabled selected data-el="period-select"></option>
            <option value="1" data-el="period-1"></option>
            <option value="2" data-el="period-2"></option>
            <option value="3" data-el="period-3"></option>
            <option value="4" data-el="period-4"></option>
        </select>

        <label for="people" data-el="people-label"></label>
        <input type="number" id="people" data-el="people-placeholder" min="1" step="1" />

        <button id="calc"><strong>⚙️<span data-el="calc-button" ></span></strong></button>


        <div class="result" id="result" style="display: none"></div>

        <div class="share-section" id="shareSection" style="display:none"></div>

        <div class="section-separator">
            <i class="fas fa-cog"></i>
        </div>

        <button id="tipsButton" type="button" class="tips-button">💡 <span data-el="tips-title"></span></button>

        <div class="progress-reminder">
            <span data-el="progress-reminder-msg"></span>
            <i class="fas fa-info-circle info-icon info-icon-blue" id="whyInfo"></i>
        </div>
        <button id="reminderButton" type="button" class="reminder-button">📅 <span data-el="reminder-title"></span></button>

        <!-- Pledge slider will now be injected dynamically into the results -->

        <p class="privacy-notice">
            <span data-el="contact-info-prefix"></span>
            <a href="#" id="contactEmail" class="email-link">kios-dwic@ucy.onmicrosoft.com</a>
        </p>
        <p class="privacy-notice">
            <a href="https://github.com/KIOS-Research/stagona_app/blob/main/privacy_policy.md" target="_blank" class="privacy-link">Privacy Policy:</a> <span data-el="privacy-notice"></span>
        </p>


    </div>

    <!-- Example Modal -->
    <div class="example-modal" id="exampleModal">
        <div class="example-modal-content">
            <i class="fas fa-times example-modal-close" id="exampleModalClose"></i>
            <h3 data-el="help-title"></h3>
            <img src="eoanicosia.png" alt="Example water bill from EOA Nicosia showing consumption data" class="example-image">
            <p data-el="help-explanation"></p>
        </div>
    </div>

    <!-- Notice Modal -->
    <div class="notice-modal" id="noticeModal">
        <div class="notice-modal-content">
            <i class="fas fa-times notice-modal-close" id="noticeModalClose"></i>
            <div class="notice-modal-message" id="noticeModalMessage"></div>
            <button class="notice-modal-button" id="noticeModalButton">OK</button>
        </div>
    </div>

    <!-- Footer -->
    <div class="footer">
        <a href="https://www.kios.ucy.ac.cy/eliades" target="_blank">Digital Water Innovations Cluster</a
        >, <a href="https://www.kios.ucy.ac.cy" target="_blank"
          >KIOS Research and Innovation Center of Excellence</a
        >, <a href="https://www.ucy.ac.cy" target="_blank">University of Cyprus. </a> <br>Copyright © 2025 KIOS CoE, UCY. All rights reserved.<br>

    </div>

    <!-- Modal -->
    <div class="modal" id="aboutModal">
        <div class="modal-content">
            <i class="fas fa-times modal-close" id="modalClose"></i>

            <div class="modal-logos">
                <img src="ucy_logo.png" alt="University of Cyprus Logo" class="modal-logo" />
                <img src="kios_logo.png" alt="KIOS Research and Innovation Center of Excellence Logo" class="modal-logo" />
            </div>

            <div class="modal-section">
                <h3 data-el="about-title"></h3>
                <p data-el="about-desc"></p>
            </div>

            <div class="modal-section">
                <h3 data-el="how-to-title"></h3>
                <p data-el="how-to-1"></p>
                <p data-el="how-to-2"></p>
                <p data-el="how-to-3"></p>
                <p data-el="how-to-4"></p>
                <p data-el="how-to-5"></p>
            </div>

            <div class="modal-section">
                <h3 data-el="privacy-title"></h3>
                <span data-el="privacy-desc"></span> (<a href="https://github.com/KIOS-Research/stagona_app/blob/main/privacy_policy.md" target="_blank" class="privacy-link">Privacy Policy</a>)
            </div>

            <div class="modal-section">
                <h3 data-el="version-title"></h3>
                <p data-el="version-number"></p>
            </div>
        </div>
    </div>

    <!-- Tips Modal -->
    <div class="modal" id="tipsModal">
        <div class="modal-content">
            <i class="fas fa-times modal-close" id="tipsModalClose"></i>
            <div class="modal-section">
                <h3 data-el="tips-title"></h3>
                <p data-el="tip-1"></p>
                <p data-el="tip-2"></p>
                <p data-el="tip-3"></p>
                <p data-el="tip-4"></p>
                <p data-el="tip-5"></p>
                <p data-el="tip-6"></p>
                <p data-el="tip-7"></p>
                <p data-el="tip-8"></p>
                <p data-el="tip-9"></p>
                <p data-el="tip-10"></p>
                <p data-el="tip-11"></p>
            </div>
        </div>
    </div>

    <!-- Water Stress Info Modal -->
    <div class="modal" id="stressInfoModal">
        <div class="modal-content">
            <i class="fas fa-times modal-close" id="stressInfoModalClose"></i>
            <div class="modal-section">
                <h3 data-el="stress-info-title"></h3>
                <p data-el="stress-info-1"></p>
                <p data-el="stress-info-2"></p>
                <p data-el="stress-info-3"></p>
                <p data-el="stress-info-4"></p>
                <p data-el="stress-info-5"></p>
            </div>
        </div>
    </div>

    <!-- Action Info Modal -->
    <div class="modal" id="actionInfoModal">
        <div class="modal-content">
            <i class="fas fa-times modal-close" id="actionInfoModalClose"></i>
            <div class="modal-section">
                <h3 data-el="action-info-title"></h3>
                <p data-el="action-info-1"></p>
                <p data-el="action-info-2"></p>
                <p data-el="action-info-3"></p>
                <p data-el="action-info-4"></p>
                <p data-el="action-info-5"></p>
            </div>
        </div>
    </div>

    <!-- Why Info Modal -->
    <div class="modal" id="whyInfoModal">
        <div class="modal-content">
            <i class="fas fa-times modal-close" id="whyInfoModalClose"></i>
            <div class="modal-section">
                <h3 data-el="why-info-title"></h3>
                <p data-el="why-info-1"></p>
                <p data-el="why-info-2"></p>
                <p data-el="why-info-3"></p>
                <p data-el="why-info-4"></p>
                <p data-el="why-info-5"></p>
                <p data-el="why-info-6"></p>
            </div>
        </div>
    </div>

    <script>
        // Translations object
        const translations = {
            el: {
                "app-title": "Stagona - Υπολογιστής Κατανάλωσης Νερού",
                "info-title": "Πληροφορίες",
                "title": "Σταγονο-μετρώ!",
                "intro-question": "Γνωρίζεις πόσα λίτρα νερού χρησιμοποιείς κάθε μέρα;<br>Πώς συγκρίνεσαι με το μέσο Κύπριο;",
                "intro-instructions": "<strong>Οδηγίες</strong>: Βρες ένα <em>πρόσφατο τιμολόγιο</em> από τον οργανισμό υδροδότησής σου, εντόπισε την <em>ολική κατανάλωση</em> σε κυβικά μέτρα (κ.μ. ή m³), συμπλήρωσε τα στοιχεία και υπολόγισε πόσα λίτρα νερό χρησιμοποιείς κάθε ημέρα στο σπίτι σου.",
                "total-label": "Συνολική κατανάλωση περιόδου (σε m³ ή κ.μ.):",
                "period-label": "Περίοδος κατανάλωσης (σε μήνες):",
                "period-select": "Επιλέξτε περίοδο ή ΕΟΑ",
                "period-1": "1 μήνας",
                "period-2": "2 μήνες (ΕΟΑ Λευκωσίας)",
                "period-3": "3 μήνες (ΕΟΑ Λάρνακας, Πάφου, Αμμοχώστου)",
                "period-4": "4 μήνες (ΕΟΑ Λεμεσού)",
                "people-label": "Αριθμός ατόμων που κατοικούν στο σπίτι:",
                "calc-button": "Υπολόγισε & Σύγκρινε",
                "privacy-notice": "Δεν συλλέγουμε προσωπικά δεδομένα μέσω της εφαρμογής, μόνο ανώνυμες στατιστικές του ιστοτόπου.",
                "privacy-title": "Απόρρητο",
                "privacy-desc": "Δεν συλλέγουμε προσωπικά δεδομένα μέσω της εφαρμογής, μόνο ανώνυμες στατιστικές του ιστοτόπου.",
                "liters": "λίτρα",
                "about-title": "Σχετικά με το Stagona App",
                "about-desc": "Η εφαρμογή σχεδιάστηκε για να βοηθήσει τα νοικοκυριά στην Κύπρο να κατανοήσουν και να βελτιστοποιήσουν την κατανάλωση νερού τους. Η εφαρμογή συγκρίνει την οικιακή κατανάλωση νερού ανά άτομο ανά ημέρα, με τον μέσο όρο της Κύπρου, και παρέχει συστάσεις για την εξοικονόμηση νερού.",
                "how-to-title": "Πώς να το χρησιμοποιήσετε",
                "how-to-1": "1. Βρείτε τον λογαριασμό κατανάλωσης νερού σας, ή υπολογίστε τη διαφορά από τον υδρομετρητής σας.",
                "how-to-2": "2. Εισάγετε τη συνολική κατανάλωση νερού σας σε κυβικά μέτρα (m³).",
                "how-to-3": "3. Επιλέγετε την ορθή περίοδο χρέωσης (ή περίοδο υπολογισμού).",
                "how-to-4": "4. Εισάγετε τον αριθμό των ατόμων που έχουν ως συνήθη κατοικία τους το νοικοκυριό.",
                "how-to-5": '5. Κάντε κλικ στο "Υπολόγισε & Σύγκρινε" για να δείτε τα αποτελέσματα.',
                "tips-title": "Συμβουλές εξοικονόμησης",
                "tip-1": "🚿 <b>Ντους:</b> Κλείνετε τη βρύση όταν δεν χρειάζεται, και στοχεύστε στα 5 λεπτά συνεχούς ροής (≈ 50L), αντί για 9 λεπτά που διαρκεί ένα μέσο μπάνο (≈ 90L)  που αντιστοιχεί 65% της καθημερινής κατανάλωσης!.",
                "tip-2": "🪣 <b>Κρύο νερό ντους:</b> Συλλέγετε το κρύο νερό σε κουβά μέχρι να ζεσταθεί (≈ 8-10 L) για καζανάκι ή φυτά.",
                "tip-3": "💧 <b>Έλεγχος για διαρροές:</b> Ελέξτετε την ένδειξη του μετρητή όταν λείπετε για περισσότερες από 2 ώρες. Αν υπάρχει κίνηση, μπορεί να υπάρχει διαρροή, η οποία να χάνει 300-900 λίτρα την ημέρα, που ισοδυναμεί στη κατανάλωση 4-6 ατόμων!",
                "tip-4": "👚 <b>Πλυντήριο ρούχων:</b> Λειτουργήστε το μόνο γεμάτο, σε πρόγραμμα Eco (≈ 45L), όποτε ειναι δυνατό, αντί για άλλα που απαιτούν περισσότερα από 100L.",
                "tip-5": "🍽️ <b>Πλυντήριο πιάτων:</b> Γεμίζετε πλήρως πριν τη χρήση (≈ 11-20L), αντί πλυσίματος στο χέρι (μέχρι 100L).",
                "tip-6": "🌱 <b>Ξηρανθεκτικά φυτά:</b> Επιλέξτε φυτά που αντέχουν στην ξηρασία για τον κήπο, όπως το Λασμαρί, η Λεβάντα, το Αγιόκλημα, ο Σχίνος, το Φούλι, κλπ.",
                "tip-7": "🧹 <b>Καθάρισμα βεράντας:</b> Σκουπίζετε και ρίξτε 1-2 κουβάδες νερού (≈ 20 L) αντί 5 λεπτά βρέξιμο με λάστιχο (≈ 100 L).",
                "tip-8": "🌿 <b>Πότισμα:</b> Γεμίστε κουβάδες (≈ 10 L ο ένας) και ποτίστε στοχευμένα. Ποτίζοντας με λάστιχο ανοικτό για 10 λεπτά, χάνονται 300L νερό, που αντιστοιχεί στη κατανάλωση 2 ατόμων!",
                "tip-9": "🪥 <b>Βούρτσισμα & ξύρισμα:</b> Κλείνετε τη βρύση όσο βουρτσίζετε δόντια ή ξυρίζεστε (< 2 λίτρα) αντί για 2-3 λεπτα ανοιχτής ροής που αντιστοιχεί σε 30 λίτρα!",
                "tip-10": "🌄 <b>Πότισμα αυγή/σούρουπο:</b> Περιορίζει την εξάτμιση έως 30 %.",
                "tip-11": "🚗 <b>Πλύσιμο αυτοκινήτου:</b> Επιλέξτε 2 κουβάδες με σφουγγάρι (≈ 20 L) αντί για λάστιχο που αντιστοιχεί σε 400 λίτρα.",
                "result-title": "Μέση κατανάλωση ανά άτομο ανά ημέρα",
                "result-diff": "Διαφορά από το μέσο όρο στην Κύπρο (≈140 λίτρα ανά άτομο ανά ημέρα)",
                "result-below": "κάτω από μέσο όρο",
                "result-above": "πάνω από μέσο όρο",
                "result-excellent": "Εξαιρετικά! Καταναλώνετε πολύ λιγότερο από τη μέση κατανάλωση στην Κύπρο.",
                "result-excellent-desc": "Ενδεικτικά, αν όλοι οι πολίτες είχαν τουλάχιστο 20% λιγότερη κατανάλωση, θα εξοικονομούσαμε περίπου 10 εκατ. m³ νερού ετησίως, που θα αρκούσε για να υδροδοτηθούν 200,000 άτομα για ένα χρόνο (που αντιστοιχεί στο πληθυσμό της Επαρχίας Λάρνακας και Αμμοχώστου)! <br><br> Συνεχίστε έτσι και βοηθήστε να εδραιωθεί η υδατική συνείδηση στην Κύπρο!",
                "result-good": "Πολύ καλά! Καταναλώνετε λιγότερο από τη μέση κατανάλωση στην Κύπρο.",
                "result-good-desc": "Ενδεικτικά, αν όλοι οι πολίτες είχαν τουλάχιστο 10% λιγότερη κατανάλωση, θα εξοικονομούσαμε περίπου 5 εκατ. m³ νερού ετησίως, που θα αρκούσε για να υδροδοτηθούν 100,000 άτομα για ένα χρόνο (που αντιστοιχεί στο πληθυσμό της Επαρχίας Πάφου)! <br><br> Συνεχίστε έτσι, και με κάποιες μικρές αλλαγές, όπως πιο σύντομα ντους κατά 1-2 λεπτά, αποφυγή χρήσης λαστίχου για πότισμα, και χρήση πλυντηρίου με πλήρες γέμισμα, θα σας φέρουν ακόμη πιο κοντά στους κορυφαίους καταναλωτές!",
                "result-average": "Μπράβο! είστε ελαφρώς κάτω από τον μέσο όρο.",
                "result-average-desc": "Ενδεικτικά, αν όλοι οι πολίτες είχαν παρόμοια κατανάλωση, θα εξοικονομούσαμε σχεδόν 2.5 εκατ. m³ ετησίως, που θα αρκούσε για να υδροδοτηθούν 50,000 άτομα για ένα χρόνο (που αντιστοιχεί στο πληθυσμό της Επαρχίας Αμμοχώστου)! <br><br> Συνεχίστε έτσι, και με κάποιες στοχευμένες αλλαγές, όπως πιο σύντομα ντους κατά 2-3 λεπτά, αποφυγή χρήσης λαστίχου για πότισμα και χρήση πλυντηρίου με πλήρες γέμισμα, θα σας φέρουν ακόμη πιο κοντά στο στόχο της μείωσης κατά 10% της μέσης σημερινής κατανάλωσης (≈ 125 λίτρα ανά άτομο ανά ημέρα)!",
                "result-slightly-high": "Είστε λίγο πάνω από το μέσο όρο, όμως με μερικές απλές κινήσεις μπορείτε να το αλλάξετε αυτό!",
                "result-slightly-high-desc": "Ξεπερνάτε τον μέσο όρο κατανάλωσης νερού στην Κύπρο, που αντιστοιχεί σε 140 λίτρα ανά άτομο ανά ημερα. Μειώνοντας το ντους μόλις κατά 2-3 λεπτά (≈ 20-30 λίτρα), μπορείτε να φτάσετε εύκολα το μέσο όρο!<br><br> Επιπρόσθετα, με κάποιες στοχευμένες αλλαγές, όπως αποφυγή χρήσης λαστίχου για πότισμα (≈ 15-30 λίτρα κάθε λεπτό), και χρήση πλυντηρίου με πλήρες γέμισμα, θα σας φέρουν ακόμη πιο κοντά στο στόχο της μείωσης κατά 10% της μέσης σημερινής κατανάλωσης (≈ 125 λίτρα ανά άτομο ανά ημέρα)!",
                "result-high": "Είστε πάνω από το μέσο όρο, όμως με μερικές απλές κινήσεις μπορείτε να το αλλάξετε αυτό!",
                "result-high-desc": "Ξεπερνάτε τον μέσο όρο κατανάλωσης νερού στην Κύπρο, που αντιστοιχεί σε 140 λίτρα ανά άτομο ανά ημερα. Μειώνοντας το ντους μόλις κατά 2-3 λεπτά (≈ 20-30 λίτρα), μπορείτε να φτάσετε εύκολα το μέσο όρο!  <br><br> Επιπρόσθετα, με κάποιες στοχευμένες αλλαγές, όπως αποφυγή χρήσης λαστίχου για πότισμα (≈ 15-30 λίτρα κάθε λεπτό), και χρήση πλυντηρίου με πλήρες γέμισμα, θα σας φέρουν ακόμη πιο κοντά στο στόχο της μείωσης κατά 10% της μέσης σημερινής κατανάλωσης (≈ 125 λίτρα ανά άτομο ανά ημέρα)!",
                "result-very-high": "Είστε αρκετά πάνω από το μέσο όρο, όμως με μερικές απλές κινήσεις μπορείτε να το αλλάξετε αυτό!",
                "result-very-high-desc": "Ξεπερνάτε σημαντικά τον μέσο όρο κατανάλωσης νερού στην Κύπρο, που αντιστοιχεί σε 140 λίτρα ανά άτομο ανά ημερα. Θα ήταν καλό να ελέγξετε την οικία σας για τυχόν διαρροές. Παράλληλα, μειώνοντας το ντους μόλις κατά 2-3 λεπτά (≈ 20-30 λίτρα), και εφαρμόζοντας κάποιες άλλες πρακτικές συμβουλές, μπορείτε να φτάσετε το μέσο όρο!  <br><br> Επιπρόσθετα, με κάποιες στοχευμένες αλλαγές, όπως αποφυγή χρήσης λαστίχου για πότισμα (≈ 15-30 λίτρα κάθε λεπτό), και χρήση πλυντηρίου με πλήρες γέμισμα, θα σας φέρουν ακόμη πιο κοντά στο στόχο της μείωσης κατά 10% της μέσης σημερινής κατανάλωσης (≈ 125 λίτρα ανά άτομο ανά ημέρα)!",
                "share-title": "Μοιραστείτε το αποτέλεσμα:",
                "copy-success": "Αντιγράφηκε!",
                "email-subject": "Κατανάλωση νερού",
                "fill-fields": "Παρακαλώ συμπληρώστε σωστά όλα τα πεδία.",
                "negative-consumption": "Η κατανάλωση νερού δεν μπορεί να είναι μηδέν ή αρνητική.",
                "negative-people": "Ο αριθμός των ατόμων δεν μπορεί να είναι μηδέν ή αρνητικός.",
                "total-placeholder": "π.χ., 30",
                "people-placeholder": "π.χ., 4",
                "copy-summary": "Αντέγραψε περίληψη",
                "version-title": "Έκδοση",
                "version-number": "1.0.0",
                "contact-info": "Για βελτιώσεις και εισηγήσεις, παρακαλούμε επικοινωνήστε μαζί μας στο kios-dwic@ucy.onmicrosoft.com",
                "contact-info-prefix": "Για βελτιώσεις και εισηγήσεις, παρακαλούμε επικοινωνήστε μαζί μας στο ",
                "example-link": "[βοήθεια]",
                "email-copied": "Το email αντιγράφηκε!",
                "scarcity-msg": "Η Κύπρος βιώνει το σοβαρότερο χρόνιο υδατικό στρες στην Ευρώπη, ενώ ταυτόχρονα <em>η έλλειψη νερού επηρεάζει το 30% των Ευρωπαίων</em>.",
                "why-msg": "Ενώ η ετήσια βροχόπτωση μειώνεται σταθερά, η ζήτηση νερού αυξάνεται. <em>Στην Κύπρο χρησιμοποιούμε 140 λίτρα ανά άτομο την ημέρα, ενώ ο μέσος όρος στην ΕΕ ειναι 124  λίτρα</em>.",
                "action-msg": "Μειώνοντας έστω κατά λίγα λεπτά την ατομική μας κατανάλωση*, μπορούμε να εξοικονομήσουμε σημαντικές ποσότητες νερού. <em>Πρακτικά, ως κοινωνία του 1 εκατ. κατοίκων, ένα λεπτό λιγότερο τρεχούμενο νερό (≈ 10 L) εξοικονομεί αρκετό νερό για 70,000 συνανθρώπους μας τον χρόνο</em>! <br><br><small>*Ντους≈ 10 λίτρα ανά λεπτό,  Πότισμα με λάστιχο≈ 15-30 λίτρα ανά λεπτό.</small>",
                "reminder-title": "Υπενθύμιση σε 1 μήνα",
                "progress-reminder-msg": "Βάλτε υπενθύμιση για να επαναλάβετε τον υπολογισμό σε 30 ημέρες και να μετρήσετε την πρόοδό σας! (καταγράψτε την ένδειξη στον μετρητή σας σήμερα.)",
                "stress-info-title": "Τι είναι το χρόνιο υδατικό στρες;",
                "stress-info-1": "Το χρόνιο υδατικό στρές είναι μια κατάσταση όπου η ζήτηση νερού υπερβαίνει τη διαθεσιμότητα για μεγάλο χρονικό διάστημα. <b>Αυτό σημαίνει ότι στην Κύπρο, καταναλώνουμε περισσότερο νερό από αυτό που μπορεί να αναπληρώσει φυσικά η βροχόπτωση</b>. ",
                "stress-info-2": "Σύμφωνα με την Ευρωπαϊκή Επιτροπή, η Κύπρος αντιμετωπίζει υψηλό επίπεδο υδατικού στρες (>40%), που την τοποθετεί ανάμεσα στις πιο ευάλωτες χώρες της Ευρώπης. <b>Ενδεικτικά, οι διαθέσιμοι φυσικοί υδάτινοι πόροι ειναι μόλις 390 κ.μ. ανά έτος ανά άτομο, τη στιγμή που το όριο ακραίας λειψυδρίας καθορίζεται στα 500 κ.μ./έτος και το όριο λειψυδρίας στα 1.000 κ.μ./έτος</b>. Σε ευρωπαϊκό επίπεδο, η λειψυδρία και οι ξηρασίες κοστίζουν έως € 9 δισ. τον χρόνο, πλήττουν το 30% των πολιτών και το 20% της γης κάθε έτος, ενώ σχεδόν οι μισοί Ευρωπαίοι τις θεωρούν τη μεγαλύτερη απειλή για τα υδάτινα αποθέματα της χώρας τους.",
                "stress-info-3": "Οι κύριοι παράγοντες που επιβαρύνουν το υδατικό στρες, είναι η αύξηση του πληθυσμού, η τουριστική ανάπτυξη, η αγροτική δραστηριότητα, και η κλιματική αλλαγή που προκαλεί σημαντική μείωση στη βροχόπτωση. <b>Παράλληλα, η ζήτηση νερού στην Κύπρο την περίοδο 2019-2023, αυξήθηκε κατά 15%</b>. ",
                "stress-info-4": "Σήμερα, υπολογίζεται ότι η μέση οικιακή κατανάλωση παραμένει στα 140 λίτρα ανά άτομο την ημέρα, ενώ ο μέσος όρος στην ΕΕ έχει πέσει στα 124 λίτρα ανά άτομο.",
                "stress-info-5": "",
                "action-info-title": "Πώς μικρές αλλαγές κάνουν μεγάλη διαφορά;",
                "action-info-1": "Πέραν από τις αφαλατώσεις, την εφαρμογή νέων τεχνολογιών και αναβάθμιση των δικτύων για μείωση των απωλειών, <b>χρειάζεται να κάνουμε συντηρητική χρήση νερού</b>. Κάθε λίτρο που εξοικονομούμε βοηθάει να διατηρήσουμε τα υπόγεια νερά και να μειώσουμε την εξάρτηση από τις αφαλατώσεις, που είναι ενεργειακά ακριβές και περιβαλλοντικά επιβαρυντικές, ενώ βοηθούμε στο να διασφαλίσουμε επαρκείς ποσότητες καλής ποιότητας νερού για την γεωργία.",
                "action-info-2": "Η μείωση κατά 1 λεπτό χρήσης νερού ανά άτομο ανά ημέρα μπορεί να φαίνεται μικρή, αλλά πολλαπλασιασμένη με τον πληθυσμό της Κύπρου (~1 εκατομμύριο) δημιουργεί τεράστια επίδραση (1 λεπτό × 10 λίτρα/λεπτό × 1 εκατομμύρια άτομα × 365 ημέρες = 3.65 εκατομμύρια m³ νερού ετησίως, που αντιστοιχεί στον ολικό όγκο των φραγμάτων της Λευκωσίας, ή στο φράγμα Πολεμιδιών!)",
                "action-info-3": "Αυτή η ποσότητα νερού μπορεί να υδροδοτήσει 70,000 άτομα για ένα χρόνο, ή να καλύψει σχεδόν τις ανάγκες της Επαρχίας Πάφου.",
                "action-info-4": "Επιπλέον, η εξοικονόμηση νερού δίνει μεγαλύτερη <b>ευελιξία στην αξιοποίηση των ποσοτήτων που παραμένουν στα φράγματα</b>, σε συνδυασμό με την αφαλάτωση, μειώνοντας το κόστος για τον καταναλωτή, καθώς και τις εκπομπές αερίων θερμοκηπίου.",
                "action-info-5": "Μικρές αλλαγές όπως: κλείσιμο της βρύσης κατά το ντους (εξοικονόμηση 40 λίτρα), βούρτσισμα δοντιών (15 λίτρα), και αποφυγή χρήσης λαστίχου (στο οποίο κάθε λεπτό φεύγουν 15-30L) μπορούν εύκολα να φέρουν σημαντικές καθημερινές εξοικονομήσεις.",
                "why-info-title": "Υπολογίστε μόνοι σας την πρόοδό σας!",
                "why-info-1": "Η παρακολούθηση της κατανάλωσης νερού μας είναι το πρώτο βήμα για τη δημιουργία συνείδησης και την εξοικονόμηση. Όταν γνωρίζουμε πόσο νερό χρησιμοποιούμε, μπορούμε να εντοπίσουμε περιττές χρήσεις και να κάνουμε πιο συνειδητές επιλογές. Πιο κάτω περιγράφουμε τη διαδικασία υπολογισμού της μηνιαίας κατανάλωσή σας.",
                "why-info-2": "📸 <b>Αρχική μέτρηση:</b> Σημειώστε τους μαύρους αριθμούς (m³ ή κ.μ.) & τα κόκκινα ψηφία (λίτρα) και βγάλτε φωτογραφία.",
                "why-info-3": "⏳ <b>Αναμονή 30 ημερών:</b> Χρησιμοποιήστε το νερό φυσιολογικά (αφαιρέστε οποιαδήποτε άλλη χρήση όπως γέμισμα πισίνας).",
                "why-info-4": "📸 <b>Τελική μέτρηση:</b> Διαβάστε ξανά τους αριθμούς & φωτογραφίστε.",
                "why-info-5": "➖ <b>Υπολογισμός:</b> Τελική – Αρχική = κατανάλωση σε m³ (σημείωση: τα κόκκινα ψηφία ειναι δεκαδικά).",
                "why-info-6": "📅 <b>Επανέλεγχος με Stagona.cy:</b> Περάστε τα στοιχεία και επιλέξτε την επιλογή 1 Μήνας για την χρονική περίοδο.",
                "jump-link-btn": "Υπολόγισέ το σε 1 λεπτό!",
                "help-title": "Πώς να βρείτε την κατανάλωση νερού στον λογαριασμό σας",
                "help-explanation": "Στον λογαριασμό σας, αναζητήστε την ενότητα \"Κατανάλωση\" ή \"Μετρήσεις\". Θα δείτε την ολική κατανάλωση σε κυβικά μέτρα (m³ ή κ.μ.) για την περίοδο χρέωσης. Εισάγετε αυτόν τον αριθμό στο πεδίο \"Συνολική κατανάλωση περιόδου\".",
                "pledge-label": "Δεσμεύομαι να μειώσω την κατανάλωση νερού κατά:",
                "pledge-estimate-label": "Νέος στόχος κατανάλωσης ανά άτομο ανά ημέρα:",
            },
            en: {
                "app-title": "Stagona - Water Consumption Calculator",
                "info-title": "Information",
                "title": "Drop-meter!",
                "intro-question": "Do you know how many liters of water you use every day?<br>How do you compare to the average Cypriot?",
                "intro-instructions": "<strong>Instructions</strong>: Find a <em>recent bill</em> from your water utility organization, locate the <em>total consumption</em> in cubic meters (m³), fill in the details and calculate how many liters of water you use every day in your home.",
                "total-label": "Total period consumption (in m³):",
                "period-label": "Consumption period (in months):",
                "period-select": "Select period or EOA",
                "period-1": "1 month",
                "period-2": "2 months (EOA Nicosia)",
                "period-3": "3 months (EOA Larnaca, Paphos, Famagusta)",
                "period-4": "4 months (EOA Limassol)",
                "people-label": "Number of people residing in the house:",
                "calc-button": "Calculate & Compare",
                "privacy-notice": "We do not collect personal data through the app, only anonymous website statistics.",
                "privacy-title": "Privacy",
                "privacy-desc": "We do not collect personal data through the app, only anonymous website statistics.",
                "liters": "liters",
                "about-title": "About Stagona App",
                "about-desc": "The app was designed to help households in Cyprus understand and optimize their water consumption. The app compares household water consumption per person per day with the average in Cyprus, and provides recommendations for water savings.",
                "how-to-title": "How to use it",
                "how-to-1": "1. Find your water consumption bill, or calculate the difference from your water meter.",
                "how-to-2": "2. Enter your total water consumption in cubic meters (m³).",
                "how-to-3": "3. Select the correct billing period (or calculation period).",
                "how-to-4": "4. Enter the number of people who have this household as their regular residence.",
                "how-to-5": '5. Click "Calculate & Compare" to see the results.',
                "tips-title": "Water Saving Tips",
                "tip-1": "🚿 <b>Shower:</b> Turn off the tap when not needed, and aim for 5 minutes of continuous flow (≈ 50L), instead of 9 minutes for an average shower (≈ 90L) which accounts for 65% of daily consumption!",
                "tip-2": "🪣 <b>Cold shower water:</b> Collect cold water in a bucket until it gets hot (≈ 8-10 L) for toilet flushing or plants.",
                "tip-3": "💧 <b>Leak detection:</b> Check your meter reading when you're away for more than 2 hours. If there's movement, there might be a leak, which can waste 300-900 liters per day, equivalent to the consumption of 4-6 people!",
                "tip-4": "👚 <b>Washing machine:</b> Operate only when full, on Eco program (≈ 45L), whenever possible, instead of others that require more than 100L.",
                "tip-5": "🍽️ <b>Dishwasher:</b> Fill completely before use (≈ 11-20L), instead of hand washing (up to 100L).",
                "tip-6": "🌱 <b>Drought-resistant plants:</b> Choose plants that withstand drought for your garden, such as Rosemary, Lavender, Sage, Pistachio, Thyme, etc.",
                "tip-7": "🧹 <b>Balcony cleaning:</b> Sweep and pour 1-2 buckets of water (≈ 20 L) instead of 5 minutes of hose spraying (≈ 100 L).",
                "tip-8": "🌿 <b>Watering:</b> Fill buckets (≈ 10 L each) and water targeted areas. Watering with an open hose for 10 minutes wastes 300L of water, equivalent to the consumption of 2 people!",
                "tip-9": "🪥 <b>Brushing & shaving:</b> Turn off the tap while brushing teeth or shaving (< 2 liters) instead of 2-3 minutes of open flow which corresponds to 30 liters!",
                "tip-10": "🌄 <b>Dawn/dusk watering:</b> Reduces evaporation by up to 30%.",
                "tip-11": "🚗 <b>Car washing:</b> Choose 2 buckets with sponge (≈ 20 L) instead of hose which corresponds to 400 liters.",
                "result-title": "Average consumption per person/day",
                "result-diff": "Difference from average in Cyprus (≈140 liters per person per day)",
                "result-below": "below average",
                "result-above": "above average",
                "result-excellent": "Excellent! You consume much less than the average consumption in Cyprus.",
                "result-excellent-desc": "Indicatively, if all citizens had at least 20% less consumption, we would save about 10 million m³ of water annually, which would be enough to supply 200,000 people for a year (equivalent to the population of Larnaca and Famagusta Districts)! <br><br> Keep it up and help establish water consciousness in Cyprus!",
                "result-good": "Very good! You consume less than the average consumption in Cyprus.",
                "result-good-desc": "Indicatively, if all citizens had at least 10% less consumption, we would save about 5 million m³ of water annually, which would be enough to supply 100,000 people for a year (equivalent to the population of Paphos District)! <br><br> Keep it up, and with some small changes, such as shorter showers by 1-2 minutes, avoiding hose use for watering, and using washing machine with full load, you'll get even closer to being among the top consumers!",
                "result-average": "Well done! You are slightly below average.",
                "result-average-desc": "Indicatively, if all citizens had similar consumption, we would save almost 2.5 million m³ annually, which would be enough to supply 50,000 people for a year (equivalent to the population of Famagusta District)! <br><br> Keep it up, and with some targeted changes, such as shorter showers by 2-3 minutes, avoiding hose use for watering and using washing machine with full load, you'll get even closer to the goal of reducing by 10% the current average consumption (≈ 125 liters per person per day)!",
                "result-slightly-high": "You are slightly above average, but with some simple moves you can change this!",
                "result-slightly-high-desc": "You exceed the average water consumption in Cyprus, which corresponds to 140 liters per person per day. By reducing your shower by just 2-3 minutes (≈ 20-30 liters), you can easily reach the average!<br><br> Additionally, with some targeted changes, such as avoiding hose use for watering (≈ 15-30 liters per minute), and using washing machine with full load, you'll get even closer to the goal of reducing by 10% the current average consumption (≈ 125 liters per person per day)!",
                "result-high": "You are above average, but with some simple moves you can change this!",
                "result-high-desc": "You exceed the average water consumption in Cyprus, which corresponds to 140 liters per person per day. By reducing your shower by just 2-3 minutes (≈ 20-30 liters), you can easily reach the average!  <br><br> Additionally, with some targeted changes, such as avoiding hose use for watering (≈ 15-30 liters per minute), and using washing machine with full load, you'll get even closer to the goal of reducing by 10% the current average consumption (≈ 125 liters per person per day)!",
                "result-very-high": "You are quite above average, but with some simple moves you can change this!",
                "result-very-high-desc": "You significantly exceed the average water consumption in Cyprus, which corresponds to 140 liters per person per day. It would be good to check your home for any leaks. At the same time, by reducing your shower by just 2-3 minutes (≈ 20-30 liters), and applying some other practical tips, you can reach the average!  <br><br> Additionally, with some targeted changes, such as avoiding hose use for watering (≈ 15-30 liters per minute), and using washing machine with full load, you'll get even closer to the goal of reducing by 10% the current average consumption (≈ 125 liters per person per day)!",
                "share-title": "Share your result:",
                "copy-success": "Copied!",
                "email-subject": "Water Consumption",
                "fill-fields": "Please fill in all fields correctly.",
                "negative-consumption": "Water consumption cannot be zero or negative.",
                "negative-people": "Number of people cannot be zero or negative.",
                "total-placeholder": "e.g., 30",
                "people-placeholder": "e.g., 4",
                "copy-summary": "Copy summary",
                "version-title": "Version",
                "version-number": "1.0.0",
                "contact-info": "For improvements and suggestions, please contact us at kios-dwic@ucy.onmicrosoft.com",
                "contact-info-prefix": "For improvements and suggestions, please contact us at ",
                "example-link": "[help]",
                "email-copied": "Email copied!",
                "scarcity-msg": "Cyprus experiences the most severe chronic water stress in Europe, while at the same time <em>water scarcity affects 30% of Europeans</em>.",
                "why-msg": "While annual rainfall is steadily decreasing, water demand is increasing. <em>In Cyprus we use 140 liters per person per day, while the average in the EU is 124 liters</em>.",
                "action-msg": "By reducing even a few minutes of our individual consumption*, we can save significant amounts of water. <em>Practically, as a society of 1 million inhabitants, one minute less running water (≈ 10 L) saves enough water for 70,000 of our fellow citizens per year</em>! <br><br><small>*Shower≈ 10 liters per minute, Watering with hose≈ 15-30 liters per minute.</small>",
                "reminder-title": "Reminder in 1 month",
                "progress-reminder-msg": "Set a reminder to repeat the calculation in 30 days and measure your progress! (record your meter reading today.)",
                "stress-info-title": "What is chronic water stress?",
                "stress-info-1": "Chronic water stress is a situation where water demand exceeds availability for a long period of time. In Cyprus, this means we consume more water than what can be naturally replenished by rainfall.",
                "stress-info-2": "According to the European Commission, Cyprus faces high water stress (>40%), placing it among the most water-stressed regions of Europe. In 2022, the water consumption in Cyprus was 140 liters per person per day.",
                "stress-info-3": "The main causes include: population growth, tourism development, agricultural activities, and climate change that reduces rainfall by 15-20% over the last 30 years.",
                "stress-info-4": "The consequences include: water cuts, increased costs, decreased water quality, and threat to biodiversity. In 2021, Cyprus faced a severe drought that led to restrictions.",
                "stress-info-5": "The solution lies in conserving water. Every liter we save helps us maintain our groundwater resources and reduce our dependency on desalination, which is energy-efficient and environmentally friendly.",
                "action-info-title": "What small changes make a big difference?",
                "action-info-1": "Saving 1 liter of water per person per day might seem small, but multiplied by the population of Cyprus (1.2 million) it creates a significant impact.",
                "action-info-2": "Calculation: 1 minute × 9 liters/minute × 1.2 million people × 365 days = 3.9 million m³ of water annually.",
                "action-info-3": "This amount of water can supply 70,000 people for a year, or cover the needs of a small city like Paphos for 6 months.",
                "action-info-4": "In addition, water conservation reduces desalination costs (€0.8/m³), saves energy, and reduces CO2 emissions by 2.5 kg per m³ of water.",
                "action-info-5": "Small changes include: turning off the tap during brushing teeth or shaving (-15L), shorter showers (-20L), and avoiding using a hose when washing your car (-15L/minute).",
                "why-info-title": "Why is it important for us to monitor our water consumption?",
                "why-info-1": "Monitoring our water consumption is the first step towards creating awareness and saving. When we know how much water we use, we can identify wasteful habits and make more conscious choices. Below we describe the process of calculating your monthly consumption.",
                "why-info-2": "The 140 liters per person per day in Cyprus is higher than the average in the EU (124 liters). This means there's room for improvement through simple changes in our daily habits.",
                "why-info-3": "Regular monitoring of our water usage allows us to track our progress and maintain good habits. It's like having a personalized feeding system.",
                "why-info-4": "Knowing our water usage makes us more conscious consumers and helps us make better decisions for our environment and economy.",
                "why-info-5": "By monitoring our water usage, we contribute to the collective effort to conserve our Cypriot water resources and improve our quality of life.",
                "why-info-6": "📅 <b>Re-check with Stagona.cy:</b> Enter the data and select the 1 Month option for the time period.",
                "jump-link-btn": "Calculate it in 1 minute!",
                "help-title": "How to find your water consumption on your bill",
                "help-explanation": "On your bill, look for the section titled \"Consumption\" or \"Measurements\". You'll see the total consumption in cubic meters (m³) for the billing period. Enter this number into the \"Total period consumption\" field.",
                "pledge-label": "I pledge to reduce my water usage by:",
                "pledge-estimate-label": "New target consumption per person/day:",
            }
        };

        let currentLang = "el";

        // Utility function to check if a string contains HTML tags
        function containsHtmlTags(str) {
            return /<[^>]*>/g.test(str);
        }

        // Utility function to safely update element content based on HTML presence
        function updateElementContent(element, content) {
            if (containsHtmlTags(content)) {
                element.innerHTML = content;
            } else {
                element.textContent = content;
            }
        }

        // DRY: Unified summary generator
        function generateSummary({
            lang = "el",
            perDay,
            diffPct,
            avg = 140,
            url = "https://stagona.cy",
            pledge = 0,
            pledgeLiters = null,
            mode = "share" // or "quote"
        }) {
            // Compose difference string
            let diffStr;
            if (lang === "el") {
                diffStr = diffPct < 0 ? `${Math.abs(diffPct).toFixed(1)}% κάτω από μέσο όρο των 140 λίτρων/ημέρα` : `${diffPct.toFixed(1)}% πάνω από μέσο όρο των 140 λίτρων/ημέρα`;
            } else {
                diffStr = diffPct < 0 ? `${Math.abs(diffPct).toFixed(1)}% below average of 140 liters/day` : `${diffPct.toFixed(1)}% above average of 140 liters/day`;
            }
            // Compose base
            let summary;
            if (lang === "el") {
                if (mode === "share") {
                    summary = `Μόλις υπολόγισα την ατομική κατανάλωσή νερού μου: ${perDay.toFixed(1)} λίτρα/ημέρα (${diffStr}).`;
                    if (pledge > 0 && pledgeLiters !== null) {
                        summary += ` Θα προσπαθήσω να τη μειώσω κατά ${pledge}% (${pledgeLiters} λίτρα/ημέρα) μέσα στον επόμενο μήνα.`;
                    }
                    summary += ` Δοκίμασέ το και εσύ: ${url}`;
                } else {
                    summary = `Μόλις υπολόγισα την ατομική κατανάλωσή νερού μου: ${perDay.toFixed(1)} λίτρα/ημέρα (${diffStr}).`;
                    if (pledge > 0 && pledgeLiters !== null) {
                        summary += ` Θα προσπαθήσω να τη μειώσω κατά ${pledge}% (${pledgeLiters} λίτρα/ημέρα) μέσα στον επόμενο μήνα.`;
                    }
                    summary += ` Δοκίμασέ το και εσύ: ${url}`;
                }
            } else {
                if (mode === "share") {
                    summary = `I've just calculated my individual water consumption: ${perDay.toFixed(1)} liters/day (${diffStr}).`;
                    if (pledge > 0 && pledgeLiters !== null) {
                        summary += ` I will try to reduce it by ${pledge}% (${pledgeLiters} liters/day) in the next month.`;
                    }
                    summary += ` Try it yourself: ${url}`;
                } else {
                    summary = `I've just calculated my individual water consumption: ${perDay.toFixed(1)} liters/day (${diffStr}).`;
                    if (pledge > 0 && pledgeLiters !== null) {
                        summary += ` I will try to reduce it by ${pledge}% (${pledgeLiters} liters/day) in the next month.`;
                    }
                    summary += ` Try it yourself: ${url}`;
                }
            }
            return summary;
        }

        // Replace createSummary
        function createSummary(perDay, diffPct, avg, url, lang) {
            // Get pledge info
            let pledge = 0;
            let pledgeLiters = null;
            const slider = document.getElementById("pledgeSlider");
            if (slider) {
                pledge = parseInt(slider.value, 10) || 0;
                pledgeLiters = (perDay * (1 - pledge / 100)).toFixed(1);
            }
            return generateSummary({
                lang,
                perDay,
                diffPct,
                avg,
                url,
                pledge,
                pledgeLiters,
                mode: "share"
            });
        }

        // Replace updateResultSummary
        function updateResultSummary() {
            // Get values
            let perDay = 140;
            let diffPct = 0;
            const totalM3 = parseFloat(document.getElementById("total").value);
            const months = parseInt(document.getElementById("period").value);
            const people = parseInt(document.getElementById("people").value);
            if (totalM3 > 0 && months > 0 && people > 0) {
                const totalLitres = totalM3 * 1000;
                const days = months * 30.4;
                perDay = totalLitres / days / people;
                diffPct = ((perDay - 140) / 140) * 100;
            }
            // Pledge
            let pledge = 0;
            let pledgeLiters = null;
            const pledgeSlider = document.getElementById("pledgeSlider");
            if (pledgeSlider) {
                pledge = parseInt(pledgeSlider.value, 10) || 0;
                pledgeLiters = (perDay * (1 - pledge / 100)).toFixed(1);
            }
            // Compose using unified generator
            const summary = generateSummary({
                lang: currentLang,
                perDay,
                diffPct,
                avg: 140,
                url: "https://stagona.cy",
                pledge,
                pledgeLiters,
                mode: "quote"
            });
            document.getElementById("resultSummary").innerHTML = summary;
        }

        // Function to update text content
        function updateLanguage(lang) {
            const elements = document.querySelectorAll("[data-el]");
            elements.forEach((element) => {
                const key = element.getAttribute("data-el");
                if (translations[lang][key]) {
                    const translation = translations[lang][key];

                    if (element.tagName === "INPUT" || element.tagName === "SELECT") {
                        element.placeholder = translation;
                    } else {
                        updateElementContent(element, translation);

                        // Update title attribute for elements that have it
                        if (element.hasAttribute("title")) {
                            element.title = translation;
                        }
                    }
                }
            });
            document.getElementById("langToggle").textContent =
                lang === "el" ? "English" : "Ελληνικά";
            document.getElementById("langToggle").title =
                lang === "el" ? "English" : "Ελληνικά";
            currentLang = lang;

            // Update existing results if they are displayed
            const result = document.getElementById("result");
            if (result.style.display !== "none") {
                const totalM3 = parseFloat(document.getElementById("total").value);
                const months = parseInt(document.getElementById("period").value);
                const people = parseInt(document.getElementById("people").value);
                const avg = 140;

                const totalLitres = totalM3 * 1000;
                const days = months * 30.4;
                const perDay = totalLitres / days / people;
                const diffPct = ((perDay - avg) / avg) * 100;

                let msg = `
            <div class="result-box">
              <p class="result-value">${perDay.toFixed(1)} ${translations[currentLang]["liters"]}</p>
              <p class="result-label">${translations[currentLang]["result-title"]}</p>
              <div class="gauge-track"><div class="gauge-fill" id="gaugeBar"></div></div>
            </div>
            <div class="result-box">
              <p class="result-diff">${
                perDay < avg
                  ? `${Math.abs(diffPct).toFixed(1)}%<br>${translations[currentLang]["result-below"]}`
                  : `${diffPct.toFixed(1)}%<br>${translations[currentLang]["result-above"]}`
              }</p>
              <p class="result-diff-label">${translations[currentLang]["result-diff"]}</p>
            </div>
            <br/>`;

              if (diffPct < -20) {
                msg += `${translations[currentLang]["result-excellent"]}<br/><br/>${translations[currentLang]["result-excellent-desc"]}`;
              } else if (diffPct >= -20 && diffPct < -10) {
                msg += `${translations[currentLang]["result-good"]}<br/><br/>${translations[currentLang]["result-good-desc"]}`;
              } else if (diffPct >= -10 && diffPct < 0) {
                msg += `${translations[currentLang]["result-average"]}<br/><br/>${translations[currentLang]["result-average-desc"]}`;
              } else if (diffPct >= 0 && diffPct < 10) {
                msg += `${translations[currentLang]["result-slightly-high"]}<br/><br/>${translations[currentLang]["result-slightly-high-desc"]}`;
              } else if (diffPct >= 10 && diffPct < 20) {
                msg += `${translations[currentLang]["result-high"]}<br/><br/>${translations[currentLang]["result-high-desc"]}`;
              } else {
                msg += `${translations[currentLang]["result-very-high"]}<br/><br/>${translations[currentLang]["result-very-high-desc"]}`;
              }

              // Add share section within the results
              msg += `<div class="share-section">
                  <strong data-el="share-title"></strong>
                  <div class="share-buttons">
                      <div class="share-button" id="shareTwitter" title="Twitter">
                          <i class="fab fa-twitter"></i>
                      </div>
                      <div class="share-button" id="shareFacebook" title="Facebook">
                          <i class="fab fa-facebook"></i>
                      </div>
                      <div class="share-button" id="shareWhatsApp" title="WhatsApp">
                          <i class="fab fa-whatsapp"></i>
                      </div>
                      <div class="share-button" id="shareViber" title="Viber">
                          <i class="fab fa-viber"></i>
                      </div>
                      <div class="share-button" id="shareEmail" title="Email">
                          <i class="fas fa-envelope"></i>
                      </div>
                      <div class="share-button" id="copySummary" title=" Copy message">
                          <i class="fas fa-clipboard"></i>
                      </div>
                  </div>
              </div>`;

            const result = document.getElementById("result");
            result.innerHTML = msg;
            result.style.display = "block";

            // Update the share title text after adding to DOM
            const shareTitleElement = result.querySelector('[data-el="share-title"]');
            if (shareTitleElement) {
                shareTitleElement.textContent = translations[currentLang]["share-title"];
            }

            const bar = document.getElementById("gaugeBar");
            const percentage = Math.min(100, Math.max(0, ((perDay - 70) / (210 - 70)) * 100));
            bar.style.width = percentage + "%";
            
            // Set color based on percentage like a thermometer
            if (percentage <= 50) {
                // 0-50%: Green to Orange (70-140 liters)
                const greenToOrange = percentage / 50; // 0 to 1
                const red = Math.round(76 + (greenToOrange * 127)); // 76 to 203
                const green = Math.round(175 - (greenToOrange * 87)); // 175 to 88
                const blue = Math.round(80 - (greenToOrange * 80)); // 80 to 0
                bar.style.background = `rgb(${red}, ${green}, ${blue})`;
            } else {
                // 50-100%: Orange to Red (140-210 liters)
                const orangeToRed = (percentage - 50) / 50; // 0 to 1
                const red = Math.round(203 + (orangeToRed * 52)); // 203 to 255
                const green = Math.round(88 - (orangeToRed * 88)); // 88 to 0
                const blue = Math.round(0); // Always 0
                bar.style.background = `rgb(${red}, ${green}, ${blue})`;
            }

            // Update share section if it's visible
            const shareSection = document.getElementById("shareSection");
            //const base = `${location.origin}${location.pathname}`;
            const base = `https://stagona.cy`;
            const url = base;

            // Use DRY summary function
            let summary = createSummary(perDay, diffPct, avg, url, lang);
            const enc = encodeURIComponent(summary);

            document.getElementById("shareTwitter").onclick = () =>
              window.open(
                `https://twitter.com/intent/tweet?text=${enc}`,
                "_blank"
              );
            document.getElementById("shareFacebook").onclick = () =>
              window.open(
                `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(
                  url
                )}&quote=${enc}`,
                "_blank"
              );
            document.getElementById("shareWhatsApp").onclick = () =>
              window.open(`https://wa.me/?text=${enc}`, "_blank");
            document.getElementById("shareViber").onclick = () =>
              window.open(`viber://forward?text=${enc}`, "_blank");
            document.getElementById("shareEmail").onclick = () => {
              try {
                const subject = currentLang === "el" ? "Κατανάλωση νερού" : "Water Consumption";
                const mailtoLink = `mailto:?subject=${encodeURIComponent(subject)}&body=${enc}`;
                window.open(mailtoLink, "_blank");
              } catch (err) {
                console.error('Failed to open email client:', err);
                showNotice(currentLang === "el" ? "Αποτυχία ανοίγματος email" : "Failed to open email client");
              }
            };
            document.getElementById("copySummary").onclick = () =>
              navigator.clipboard
                .writeText(summary)
                .then(() => showNotice(translations[lang]["copy-success"]));
          }
        }

      // Language toggle button click handler
      document.getElementById("langToggle").addEventListener("click", () => {
        const newLang = currentLang === "el" ? "en" : "el";
        updateLanguage(newLang);
      });

      // Ensure all translations are set on page load
      updateLanguage(currentLang);

      document.getElementById("calc").addEventListener("click", () => {
        const totalM3 = parseFloat(document.getElementById("total").value);
        const months = parseInt(document.getElementById("period").value);
        const people = parseInt(document.getElementById("people").value);
        const avg = 140;

        if (totalM3 <= 0) {
          showNotice(translations[currentLang]["negative-consumption"]);
          return;
        }

        if (people <= 0) {
          showNotice(translations[currentLang]["negative-people"]);
          return;
        }
        
        if (!totalM3){document.getElementById("total").focus();return;}
        if (!months){document.getElementById("period").focus();return;}
        if (!people){document.getElementById("people").focus();return;}
        const totalLitres = totalM3 * 1000;
        const days = months * 30.4;
        const perDay = totalLitres / days / people;
        const diffPct = ((perDay - avg) / avg) * 100;

        let msg = `
          <div class="result-box">
            <p class="result-value">${perDay.toFixed(1)} λίτρα</p>
            <p class="result-label">${translations[currentLang]["result-title"]}</p>
            <div class="gauge-track"><div class="gauge-fill" id="gaugeBar"></div></div>
          </div>
          <div class="result-box">
            <p class="result-diff">${
              perDay < avg
                ? `${Math.abs(diffPct).toFixed(1)}%<br>${translations[currentLang]["result-below"]}`
                : `${diffPct.toFixed(1)}%<br>${translations[currentLang]["result-above"]}`
            }</p>
            <p class="result-diff-label">${translations[currentLang]["result-diff"]}</p>
          </div>
          <br/>`;

        if (diffPct < -20) {
          msg += `${translations[currentLang]["result-excellent"]}<br/><br/>${translations[currentLang]["result-excellent-desc"]}`;
        } else if (diffPct >= -20 && diffPct < -10) {
          msg += `${translations[currentLang]["result-good"]}<br/><br/>${translations[currentLang]["result-good-desc"]}`;
        } else if (diffPct >= -10 && diffPct < 0) {
          msg += `${translations[currentLang]["result-average"]}<br/><br/>${translations[currentLang]["result-average-desc"]}`;
        } else if (diffPct >= 0 && diffPct < 10) {
          msg += `${translations[currentLang]["result-slightly-high"]}<br/><br/>${translations[currentLang]["result-slightly-high-desc"]}`;
        } else if (diffPct >= 10 && diffPct < 20) {
          msg += `${translations[currentLang]["result-high"]}<br/><br/>${translations[currentLang]["result-high-desc"]}`;
        } else {
          msg += `${translations[currentLang]["result-very-high"]}<br/><br/>${translations[currentLang]["result-very-high-desc"]}`;
        }

        // Insert pledge slider and estimate box here, before share section
        msg += `
        <div class="pledge-slider-section result-box">
            <label for="pledgeSlider" id="pledgeSliderLabel"></label>
            <input type="range" id="pledgeSlider" min="0" max="50" step="5" value="10">
        </div>
        <strong data-el="share-title"></strong>
        <div id="resultSummary"></div>
        `;
                // Add share section within the results
        msg += `<div class="share-section">
            <div class="share-buttons">
                <div class="share-button" id="shareTwitter" title="Twitter">
                    <i class="fab fa-twitter"></i>
                </div>
                <div class="share-button" id="shareFacebook" title="Facebook">
                    <i class="fab fa-facebook"></i>
                </div>
                <div class="share-button" id="shareWhatsApp" title="WhatsApp">
                    <i class="fab fa-whatsapp"></i>
                </div>
                <div class="share-button" id="shareViber" title="Viber">
                    <i class="fab fa-viber"></i>
                </div>
                <div class="share-button" id="shareEmail" title="Email">
                    <i class="fas fa-envelope"></i>
                </div>
                <div class="share-button" id="copySummary" title=" Copy message">
                    <i class="fas fa-clipboard"></i>
                </div>
            </div>
        </div>`;



        const result = document.getElementById("result");
        result.innerHTML = msg;
        result.style.display = "block";

        // Update the share title text after adding to DOM
        const shareTitleElement = result.querySelector('[data-el="share-title"]');
        if (shareTitleElement) {
            shareTitleElement.textContent = translations[currentLang]["share-title"];
        }

        const bar = document.getElementById("gaugeBar");
        const percentage = Math.min(100, Math.max(0, ((perDay - 70) / (210 - 70)) * 100));
        bar.style.width = percentage + "%";
        
        // Set color based on percentage like a thermometer
        if (percentage <= 50) {
            // 0-50%: Green to Orange (70-140 liters)
            const greenToOrange = percentage / 50; // 0 to 1
            const red = Math.round(76 + (greenToOrange * 127)); // 76 to 203
            const green = Math.round(175 - (greenToOrange * 87)); // 175 to 88
            const blue = Math.round(80 - (greenToOrange * 80)); // 80 to 0
            bar.style.background = `rgb(${red}, ${green}, ${blue})`;
        } else {
            // 50-100%: Orange to Red (140-210 liters)
            const orangeToRed = (percentage - 50) / 50; // 0 to 1
            const red = Math.round(203 + (orangeToRed * 52)); // 203 to 255
            const green = Math.round(88 - (orangeToRed * 88)); // 88 to 0
            const blue = Math.round(0); // Always 0
            bar.style.background = `rgb(${red}, ${green}, ${blue})`;
        }

        //const base = `${location.origin}${location.pathname}`;
        const base = `https://stagona.cy`;
        const params = `?total=${totalM3}&period=${months}&people=${people}`;
        const url = base;

        // Use DRY summary function
        let summary = createSummary(perDay, diffPct, avg, url, currentLang);
        const enc = encodeURIComponent(summary);

        document.getElementById("shareTwitter").onclick = () => {
            const currentSummary = createSummary(perDay, diffPct, avg, url, currentLang);
            const enc = encodeURIComponent(currentSummary);
            window.open(`https://twitter.com/intent/tweet?text=${enc}`, "_blank");
        };
        document.getElementById("shareFacebook").onclick = () => {
            const currentSummary = createSummary(perDay, diffPct, avg, url, currentLang);
            const enc = encodeURIComponent(currentSummary);
            window.open(
                `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(
                    url
                )}&quote=${enc}`,
                "_blank"
            );
        };
        document.getElementById("shareWhatsApp").onclick = () => {
            const currentSummary = createSummary(perDay, diffPct, avg, url, currentLang);
            const enc = encodeURIComponent(currentSummary);
            window.open(`https://wa.me/?text=${enc}`, "_blank");
        };
        document.getElementById("shareViber").onclick = () => {
            const currentSummary = createSummary(perDay, diffPct, avg, url, currentLang);
            const enc = encodeURIComponent(currentSummary);
            window.open(`viber://forward?text=${enc}`, "_blank");
        };
        document.getElementById("shareEmail").onclick = () => {
            try {
                const currentSummary = createSummary(perDay, diffPct, avg, url, currentLang);
                const enc = encodeURIComponent(currentSummary);
                const subject = currentLang === "el" ? "Κατανάλωση νερού" : "Water Consumption";
                const mailtoLink = `mailto:?subject=${encodeURIComponent(subject)}&body=${enc}`;
                window.open(mailtoLink, "_blank");
            } catch (err) {
                console.error('Failed to open email client:', err);
                showNotice(currentLang === "el" ? "Αποτυχία ανοίγματος email" : "Failed to open email client");
            }
        };
        document.getElementById("copySummary").onclick = () => {
            const currentSummary = createSummary(perDay, diffPct, avg, url, currentLang);
            navigator.clipboard
                .writeText(currentSummary)
                .then(() => showNotice(translations[currentLang]["copy-success"]));
        };

        // Initialize pledge slider and estimate box logic after injection
        const pledgeSlider = document.getElementById("pledgeSlider");
        function updatePledgeLabel() {
            const label = document.getElementById("pledgeSliderLabel");
            if (label) {
                let percent = 10;
                if (pledgeSlider) {
                    percent = pledgeSlider.value;
                }
                // Calculate liters
                let perDay = 140;
                const resultValueElem = document.querySelector('.result-value');
                if (resultValueElem) {
                    const match = resultValueElem.textContent.match(/([\d.]+)/);
                    if (match) {
                        perDay = parseFloat(match[1]);
                    }
                }
                const newLiters = (perDay * (1 - percent / 100)).toFixed(1);
                const unit = currentLang === "el" ? "λίτρα" : "liters";
                label.innerHTML = `${translations[currentLang]["pledge-label"]} <span id='pledgeValue'>${percent}%</span> (${newLiters} ${unit})`;
            }
        }
        function updatePledgeValue(val) {
            // Update the percent and liters in the label inline
            updatePledgeLabel();
        }
        if (pledgeSlider) {
            updatePledgeLabel(); // Set initial label with percent and liters
            pledgeSlider.addEventListener("input", function() {
                updatePledgeLabel(); // Update label with new percent and liters
            });
        } else {
            updatePledgeLabel();
        }

        // Update pledge label on language change (patch updateLanguage)
        if (!window._origUpdateLanguagePledge) {
            window._origUpdateLanguagePledge = updateLanguage;
            updateLanguage = function(lang) {
                window._origUpdateLanguagePledge(lang);
                updatePledgeLabel();
            };
        }

        // After rendering the result, update the summary sentence
        updateResultSummary();
        if (pledgeSlider) {
            pledgeSlider.addEventListener("input", updateResultSummary);
        }

        // Also update summary on language change
        if (!window._origUpdateLanguagePledgeSummary) {
            window._origUpdateLanguagePledgeSummary = updateLanguage;
            updateLanguage = function(lang) {
                window._origUpdateLanguagePledgeSummary(lang);
                updatePledgeLabel();
                updateResultSummary();
            };
        }
      });

      // Modal functionality
      const modal = document.getElementById("aboutModal");
      const infoButton = document.getElementById("infoButton");
      const modalClose = document.getElementById("modalClose");

      function openModal(modalElement) {
          modalElement.style.display = "flex";
          document.body.style.overflow = "hidden";
      }

      function closeModal(modalElement) {
          modalElement.style.display = "none";
          document.body.style.overflow = "auto";
      }

      infoButton.onclick = () => {
          openModal(modal);
      };

      modalClose.onclick = () => {
          closeModal(modal);
      };

      window.onclick = (event) => {
          if (event.target === modal) {
              closeModal(modal);
          }
      };

      // Notice Modal functionality
      const noticeModal = document.getElementById("noticeModal");
      const noticeModalClose = document.getElementById("noticeModalClose");
      const noticeModalButton = document.getElementById("noticeModalButton");
      const noticeModalMessage = document.getElementById("noticeModalMessage");

      function showNotice(message) {
          noticeModalMessage.textContent = message;
          openModal(noticeModal);
      }

      function hideNotice() {
          closeModal(noticeModal);
      }

      noticeModalClose.onclick = hideNotice;
      noticeModalButton.onclick = hideNotice;
      noticeModal.onclick = (event) => {
          if (event.target === noticeModal) {
              hideNotice();
          }
      };

      // Add translations for the email copied message
      translations.el["email-copied"] = "Το email αντιγράφηκε!";
      translations.en["email-copied"] = "Email copied!";

      // Add email copy functionality with error handling
      document.getElementById('contactEmail').addEventListener('click', function(e) {
        e.preventDefault();
        const email = this.textContent;
        navigator.clipboard.writeText(email)
          .then(() => {
            showNotice(translations[currentLang]["email-copied"]);
          })
          .catch(err => {
            console.error('Failed to copy email:', err);
            showNotice(currentLang === "el" ? "Αποτυχία αντιγραφής email" : "Failed to copy email");
          });
      });

      // Add event listener for about links
      document.addEventListener('click', function(e) {
        if (e.target.classList.contains('about-link')) {
          e.preventDefault();
          document.getElementById('aboutModal').style.display = 'flex';
        }
      });

      // Example modal functionality
      const exampleModal = document.getElementById('exampleModal');
      const exampleModalClose = document.getElementById('exampleModalClose');

      document.addEventListener('click', function(e) {
        if (e.target.classList.contains('example-link')) {
          e.preventDefault();
          openModal(exampleModal);
        }
      });

      exampleModalClose.onclick = () => {
        closeModal(exampleModal);
      };

      exampleModal.onclick = (event) => {
        if (event.target === exampleModal) {
          closeModal(exampleModal);
        }
      };

      // Initialize the page in Greek
      updateLanguage("el");

      // Tips Modal functionality
      const tipsModal = document.getElementById('tipsModal');
      const tipsModalClose = document.getElementById('tipsModalClose');
      const tipsButton = document.getElementById('tipsButton');
      if (tipsButton) {
        tipsButton.onclick = () => {
          openModal(tipsModal);
        };
      }
      tipsModalClose.onclick = () => {
        closeModal(tipsModal);
      };
      tipsModal.onclick = (event) => {
        if (event.target === tipsModal) {
          closeModal(tipsModal);
        }
      };

      // Reminder Button functionality
      const reminderButton = document.getElementById('reminderButton');
      if (reminderButton) {
        reminderButton.onclick = () => {
            // Calculate date in one month
            const oneMonthFromNow = new Date();
            oneMonthFromNow.setMonth(oneMonthFromNow.getMonth() + 1);
            
            // Format date for calendar (all-day event)
            const year = oneMonthFromNow.getFullYear();
            const month = String(oneMonthFromNow.getMonth() + 1).padStart(2, '0');
            const day = String(oneMonthFromNow.getDate()).padStart(2, '0');
            
            const startDate = `${year}${month}${day}`;
            const endDate = `${year}${month}${day}`;
            
            // Create event details
            const eventTitle = currentLang === 'el' ? 'Stagona.cy: Έλεγχος κατανάλωσης νερού' : 'Stagona.cy: Water consumption check';
            const eventDescription = currentLang === 'el' 
                ? '<b>Κατάγραψε την κατανάλωση του μετρητή σου:</b><br>Έλεγξε ξανά την κατανάλωση νερού σου στο Stagona App: https://stagona.cy'
                : '<b>Record your water consumption:</b><br>Check your water consumption again on Stagona App: https://stagona.cy';
            
            // Create calendar URL for all-day event
            const calendarUrl = `https://calendar.google.com/calendar/render?action=TEMPLATE&text=${encodeURIComponent(eventTitle)}&details=${encodeURIComponent(eventDescription)}&dates=${startDate}/${endDate}&sf=true`;
            
            // Open calendar in new tab
            window.open(calendarUrl, '_blank');
            
            // Show success message
            const successMsg = currentLang === 'el' 
                ? 'Η υπενθύμιση προστέθηκε στον ημερολόγιο σας!' 
                : 'Reminder added to your calendar!';
            showNotice(successMsg);
        };
      }

      // Water Stress Info Modal functionality
      const stressInfoModal = document.getElementById('stressInfoModal');
      const stressInfoModalClose = document.getElementById('stressInfoModalClose');
      const stressInfoButton = document.getElementById('stressInfo');

      if (stressInfoButton) {
        stressInfoButton.onclick = () => {
          openModal(stressInfoModal);
        };
      }

      stressInfoModalClose.onclick = () => {
        closeModal(stressInfoModal);
      };

      stressInfoModal.onclick = (event) => {
        if (event.target === stressInfoModal) {
          closeModal(stressInfoModal);
        }
      };

      // Action Info Modal functionality
      const actionInfoModal = document.getElementById('actionInfoModal');
      const actionInfoModalClose = document.getElementById('actionInfoModalClose');
      const actionInfoButton = document.getElementById('actionInfo');

      if (actionInfoButton) {
        actionInfoButton.onclick = () => {
          openModal(actionInfoModal);
        };
      }

      actionInfoModalClose.onclick = () => {
        closeModal(actionInfoModal);
      };

      actionInfoModal.onclick = (event) => {
        if (event.target === actionInfoModal) {
          closeModal(actionInfoModal);
        }
      };

      // Why Info Modal functionality
      const whyInfoModal = document.getElementById('whyInfoModal');
      const whyInfoModalClose = document.getElementById('whyInfoModalClose');
      const whyInfoButton = document.getElementById('whyInfo');

      if (whyInfoButton) {
        whyInfoButton.onclick = () => {
          openModal(whyInfoModal);
        };
      }

      whyInfoModalClose.onclick = () => {
        closeModal(whyInfoModal);
      };

      whyInfoModal.onclick = (event) => {
        if (event.target === whyInfoModal) {
          closeModal(whyInfoModal);
        }
      };

      document.addEventListener("DOMContentLoaded", function() {
        updateLanguage(currentLang);
        
        // Prevent automatic scrolling to instructions on page load
        if (window.location.hash === '#instructions') {
            // Remove the hash from URL without scrolling
            history.replaceState(null, null, window.location.pathname + window.location.search);
        }
      });

      // Add translations for the pledge slider label
      translations.el["pledge-label"] = "Θα προσπαθήσω να μειώσω την κατανάλωση νερού κατά:";
      translations.en["pledge-label"] = "I pledge to reduce my water usage by:";

      // Pledge slider logic
      function updatePledgeLabel() {
          const label = document.getElementById("pledgeSliderLabel");
          if (label) {
              label.textContent = translations[currentLang]["pledge-label"];
          }
          // Also update the estimate label and unit
          const estimateLabel = document.getElementById("pledgeEstimateLabel");
          if (estimateLabel) {
              estimateLabel.textContent = translations[currentLang]["pledge-estimate-label"];
          }
          const estimateUnit = document.getElementById("pledgeEstimateUnit");
          if (estimateUnit) {
              estimateUnit.textContent = currentLang === "el" ? "λίτρα" : "liters";
          }
      }
      function updatePledgeValue(val) {
          const valueSpan = document.getElementById("pledgeValue");
          if (valueSpan) {
              valueSpan.textContent = val + "%";
          }
          // Update the estimate value using the calculated perDay value
          const estimateValue = document.getElementById("pledgeEstimateValue");
          if (estimateValue) {
              const percent = parseInt(val, 10) || 0;
              // Try to get the actual result value from the DOM
              let perDay = 140;
              const resultValueElem = document.querySelector('.result-value');
              if (resultValueElem) {
                  // Extract the number from the text, which is like "123.4 λίτρα" or "123.4 liters"
                  const match = resultValueElem.textContent.match(/([\d.]+)/);
                  if (match) {
                      perDay = parseFloat(match[1]);
                  }
              }
              const newLiters = (perDay * (1 - percent / 100)).toFixed(1);
              estimateValue.textContent = newLiters;
          }
      }
      // Initialize pledge slider
      const pledgeSlider = document.getElementById("pledgeSlider");
      if (pledgeSlider) {
          updatePledgeValue(pledgeSlider.value);
          pledgeSlider.addEventListener("input", function() {
              updatePledgeValue(this.value);
          });
      }
      updatePledgeLabel();
      // Update pledge label on language change
      const origUpdateLanguage = updateLanguage;
      updateLanguage = function(lang) {
          origUpdateLanguage(lang);
          updatePledgeLabel();
      };

      function getPledgePhrase(lang) {
          const slider = document.getElementById("pledgeSlider");
          const val = slider ? parseInt(slider.value, 10) : 0;
          if (val > 0) {
              const liters = document.getElementById("pledgeEstimateValue")?.textContent || "";
              if (lang === "el") {
                  return `\nΔεσμεύομαι να μειώσω την κατανάλωση νερού κατά ${val}% (${liters} λίτρα).`;
              } else {
                  return `\nI pledge to reduce my water consumption by ${val}% (${liters} liters).`;
              }
          }
          return "";
      }

      function getShareSummary(lang) {
          let summary = createSummary(perDay, diffPct, avg, url, lang);
          summary += getPledgePhrase(lang);
          return summary;
      }

      document.getElementById("shareTwitter").onclick = () => {
          const summary = getShareSummary(currentLang);
          const enc = encodeURIComponent(summary);
          window.open(`https://twitter.com/intent/tweet?text=${enc}`, "_blank");
      };
      document.getElementById("shareFacebook").onclick = () => {
          const summary = getShareSummary(currentLang);
          const enc = encodeURIComponent(summary);
          window.open(
              `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(url)}&quote=${enc}`,
              "_blank"
          );
      };
      document.getElementById("shareWhatsApp").onclick = () => {
          const summary = getShareSummary(currentLang);
          const enc = encodeURIComponent(summary);
          window.open(`https://wa.me/?text=${enc}`, "_blank");
      };
      document.getElementById("shareViber").onclick = () => {
          const summary = getShareSummary(currentLang);
          const enc = encodeURIComponent(summary);
          window.open(`viber://forward?text=${enc}`, "_blank");
      };
      document.getElementById("shareEmail").onclick = () => {
          try {
              const summary = getShareSummary(currentLang);
              const enc = encodeURIComponent(summary);
              const subject = currentLang === "el" ? "Κατανάλωση νερού" : "Water Consumption";
              const mailtoLink = `mailto:?subject=${encodeURIComponent(subject)}&body=${enc}`;
              window.open(mailtoLink, "_blank");
          } catch (err) {
              console.error('Failed to open email client:', err);
              showNotice(currentLang === "el" ? "Αποτυχία ανοίγματος email" : "Failed to open email client");
          }
      };
      document.getElementById("copySummary").onclick = () => {
          const summary = getShareSummary(currentLang);
          navigator.clipboard
              .writeText(summary)
              .then(() => showNotice(translations[lang]["copy-success"]));
      };

      if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('/sw.js')
      .then(() => console.log('SW registered'))
      .catch(console.error);
  }
    </script>
</body>

</html>